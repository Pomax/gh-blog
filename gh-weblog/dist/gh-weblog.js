!function t(e,n,s){function i(o,a){if(!n[o]){if(!e[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){var n=e[o][1][t];return i(n?n:t)},c,c.exports,t,e,n,s)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<s.length;o++)i(s[o]);return i}({1:[function(t){!function(){var e=document.getElementById("gh-weblog");if(!e){var n="no target element with id 'gh-weblog' found to inject gh-weblog into.";return console.error(n)}var s=window.React,i=t("./WebLog.jsx");s.render(s.createElement(i,{base:"http://pomax.github.io/gh-blog",title:"Github weblogging",description:"A free, simple github-based blogging platform"}),e)}()},{"./WebLog.jsx":8}],2:[function(t,e,n){(function(t){(function(){function t(t){this.tokens=[],this.tokens.links={},this.options=t||u.defaults,this.rules=p.normal,this.options.gfm&&(this.rules=this.options.tables?p.tables:p.gfm)}function s(t,e){if(this.options=e||u.defaults,this.links=t,this.rules=d.normal,this.renderer=this.options.renderer||new i,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.rules=this.options.breaks?d.breaks:d.gfm:this.options.pedantic&&(this.rules=d.pedantic)}function i(t){this.options=t||{}}function r(t){this.tokens=[],this.token=null,this.options=t||u.defaults,this.options.renderer=this.options.renderer||new i,this.renderer=this.options.renderer,this.renderer.options=this.options}function o(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function a(t){return t.replace(/&([#\w]+);/g,function(t,e){return e=e.toLowerCase(),"colon"===e?":":"#"===e.charAt(0)?String.fromCharCode("x"===e.charAt(1)?parseInt(e.substring(2),16):+e.substring(1)):""})}function l(t,e){return t=t.source,e=e||"",function n(s,i){return s?(i=i.source||i,i=i.replace(/(^|[^\[])\^/g,"$1"),t=t.replace(s,i),n):new RegExp(t,e)}}function h(){}function c(t){for(var e,n,s=1;s<arguments.length;s++){e=arguments[s];for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}function u(e,n,s){if(s||"function"==typeof n){s||(s=n,n=null),n=c({},u.defaults,n||{});var i,a,l=n.highlight,h=0;try{i=t.lex(e,n)}catch(p){return s(p)}a=i.length;var d=function(){var t,e;try{t=r.parse(i,n)}catch(o){e=o}return n.highlight=l,e?s(e):s(null,t)};if(!l||l.length<3)return d();if(delete n.highlight,!a)return d();for(;h<i.length;h++)!function(t){return"code"!==t.type?--a||d():l(t.text,t.lang,function(e,n){return null==n||n===t.text?--a||d():(t.text=n,t.escaped=!0,void(--a||d()))})}(i[h])}else try{return n&&(n=c({},u.defaults,n)),r.parse(t.lex(e,n),n)}catch(p){if(p.message+="\nPlease report this to https://github.com/chjj/marked.",(n||u.defaults).silent)return"<p>An error occured:</p><pre>"+o(p.message+"",!0)+"</pre>";throw p}}var p={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:h,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:h,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:h,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};p.bullet=/(?:[*+-]|\d+\.)/,p.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,p.item=l(p.item,"gm")(/bull/g,p.bullet)(),p.list=l(p.list)(/bull/g,p.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+p.def.source+")")(),p.blockquote=l(p.blockquote)("def",p.def)(),p._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",p.html=l(p.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,p._tag)(),p.paragraph=l(p.paragraph)("hr",p.hr)("heading",p.heading)("lheading",p.lheading)("blockquote",p.blockquote)("tag","<"+p._tag)("def",p.def)(),p.normal=c({},p),p.gfm=c({},p.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/}),p.gfm.paragraph=l(p.paragraph)("(?!","(?!"+p.gfm.fences.source.replace("\\1","\\2")+"|"+p.list.source.replace("\\1","\\3")+"|")(),p.tables=c({},p.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=p,t.lex=function(e,n){var s=new t(n);return s.lex(e)},t.prototype.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(t,!0)},t.prototype.token=function(t,e,n){for(var s,i,r,o,a,l,h,c,u,t=t.replace(/^ +$/gm,"");t;)if((r=this.rules.newline.exec(t))&&(t=t.substring(r[0].length),r[0].length>1&&this.tokens.push({type:"space"})),r=this.rules.code.exec(t))t=t.substring(r[0].length),r=r[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?r:r.replace(/\n+$/,"")});else if(r=this.rules.fences.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"code",lang:r[2],text:r[3]});else if(r=this.rules.heading.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"heading",depth:r[1].length,text:r[2]});else if(e&&(r=this.rules.nptable.exec(t))){for(t=t.substring(r[0].length),l={type:"table",header:r[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:r[3].replace(/\n$/,"").split("\n")},c=0;c<l.align.length;c++)l.align[c]=/^ *-+: *$/.test(l.align[c])?"right":/^ *:-+: *$/.test(l.align[c])?"center":/^ *:-+ *$/.test(l.align[c])?"left":null;for(c=0;c<l.cells.length;c++)l.cells[c]=l.cells[c].split(/ *\| */);this.tokens.push(l)}else if(r=this.rules.lheading.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"heading",depth:"="===r[2]?1:2,text:r[1]});else if(r=this.rules.hr.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"hr"});else if(r=this.rules.blockquote.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"blockquote_start"}),r=r[0].replace(/^ *> ?/gm,""),this.token(r,e,!0),this.tokens.push({type:"blockquote_end"});else if(r=this.rules.list.exec(t)){for(t=t.substring(r[0].length),o=r[2],this.tokens.push({type:"list_start",ordered:o.length>1}),r=r[0].match(this.rules.item),s=!1,u=r.length,c=0;u>c;c++)l=r[c],h=l.length,l=l.replace(/^ *([*+-]|\d+\.) +/,""),~l.indexOf("\n ")&&(h-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+h+"}","gm"),"")),this.options.smartLists&&c!==u-1&&(a=p.bullet.exec(r[c+1])[0],o===a||o.length>1&&a.length>1||(t=r.slice(c+1).join("\n")+t,c=u-1)),i=s||/\n\n(?!\s*$)/.test(l),c!==u-1&&(s="\n"===l.charAt(l.length-1),i||(i=s)),this.tokens.push({type:i?"loose_item_start":"list_item_start"}),this.token(l,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(r=this.rules.html.exec(t))t=t.substring(r[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:"pre"===r[1]||"script"===r[1]||"style"===r[1],text:r[0]});else if(!n&&e&&(r=this.rules.def.exec(t)))t=t.substring(r[0].length),this.tokens.links[r[1].toLowerCase()]={href:r[2],title:r[3]};else if(e&&(r=this.rules.table.exec(t))){for(t=t.substring(r[0].length),l={type:"table",header:r[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:r[3].replace(/(?: *\| *)?\n$/,"").split("\n")},c=0;c<l.align.length;c++)l.align[c]=/^ *-+: *$/.test(l.align[c])?"right":/^ *:-+: *$/.test(l.align[c])?"center":/^ *:-+ *$/.test(l.align[c])?"left":null;for(c=0;c<l.cells.length;c++)l.cells[c]=l.cells[c].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(e&&(r=this.rules.paragraph.exec(t)))t=t.substring(r[0].length),this.tokens.push({type:"paragraph",text:"\n"===r[1].charAt(r[1].length-1)?r[1].slice(0,-1):r[1]});else if(r=this.rules.text.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"text",text:r[0]});else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0));return this.tokens};var d={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:h,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:h,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};d._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,d._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,d.link=l(d.link)("inside",d._inside)("href",d._href)(),d.reflink=l(d.reflink)("inside",d._inside)(),d.normal=c({},d),d.pedantic=c({},d.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),d.gfm=c({},d.normal,{escape:l(d.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:l(d.text)("]|","~]|")("|","|https?://|")()}),d.breaks=c({},d.gfm,{br:l(d.br)("{2,}","*")(),text:l(d.gfm.text)("{2,}","*")()}),s.rules=d,s.output=function(t,e,n){var i=new s(e,n);return i.output(t)},s.prototype.output=function(t){for(var e,n,s,i,r="";t;)if(i=this.rules.escape.exec(t))t=t.substring(i[0].length),r+=i[1];else if(i=this.rules.autolink.exec(t))t=t.substring(i[0].length),"@"===i[2]?(n=this.mangle(":"===i[1].charAt(6)?i[1].substring(7):i[1]),s=this.mangle("mailto:")+n):(n=o(i[1]),s=n),r+=this.renderer.link(s,null,n);else if(this.inLink||!(i=this.rules.url.exec(t))){if(i=this.rules.tag.exec(t))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),t=t.substring(i[0].length),r+=this.options.sanitize?o(i[0]):i[0];else if(i=this.rules.link.exec(t))t=t.substring(i[0].length),this.inLink=!0,r+=this.outputLink(i,{href:i[2],title:i[3]}),this.inLink=!1;else if((i=this.rules.reflink.exec(t))||(i=this.rules.nolink.exec(t))){if(t=t.substring(i[0].length),e=(i[2]||i[1]).replace(/\s+/g," "),e=this.links[e.toLowerCase()],!e||!e.href){r+=i[0].charAt(0),t=i[0].substring(1)+t;continue}this.inLink=!0,r+=this.outputLink(i,e),this.inLink=!1}else if(i=this.rules.strong.exec(t))t=t.substring(i[0].length),r+=this.renderer.strong(this.output(i[2]||i[1]));else if(i=this.rules.em.exec(t))t=t.substring(i[0].length),r+=this.renderer.em(this.output(i[2]||i[1]));else if(i=this.rules.code.exec(t))t=t.substring(i[0].length),r+=this.renderer.codespan(o(i[2],!0));else if(i=this.rules.br.exec(t))t=t.substring(i[0].length),r+=this.renderer.br();else if(i=this.rules.del.exec(t))t=t.substring(i[0].length),r+=this.renderer.del(this.output(i[1]));else if(i=this.rules.text.exec(t))t=t.substring(i[0].length),r+=o(this.smartypants(i[0]));else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0))}else t=t.substring(i[0].length),n=o(i[1]),s=n,r+=this.renderer.link(s,null,n);return r},s.prototype.outputLink=function(t,e){var n=o(e.href),s=e.title?o(e.title):null;return"!"!==t[0].charAt(0)?this.renderer.link(n,s,this.output(t[1])):this.renderer.image(n,s,o(t[1]))},s.prototype.smartypants=function(t){return this.options.smartypants?t.replace(/--/g,"—").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):t},s.prototype.mangle=function(t){for(var e,n="",s=t.length,i=0;s>i;i++)e=t.charCodeAt(i),Math.random()>.5&&(e="x"+e.toString(16)),n+="&#"+e+";";return n},i.prototype.code=function(t,e,n){if(this.options.highlight){var s=this.options.highlight(t,e);null!=s&&s!==t&&(n=!0,t=s)}return e?'<pre><code class="'+this.options.langPrefix+o(e,!0)+'">'+(n?t:o(t,!0))+"\n</code></pre>\n":"<pre><code>"+(n?t:o(t,!0))+"\n</code></pre>"},i.prototype.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},i.prototype.html=function(t){return t},i.prototype.heading=function(t,e,n){return"<h"+e+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+t+"</h"+e+">\n"},i.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.prototype.list=function(t,e){var n=e?"ol":"ul";return"<"+n+">\n"+t+"</"+n+">\n"},i.prototype.listitem=function(t){return"<li>"+t+"</li>\n"},i.prototype.paragraph=function(t){return"<p>"+t+"</p>\n"},i.prototype.table=function(t,e){return"<table>\n<thead>\n"+t+"</thead>\n<tbody>\n"+e+"</tbody>\n</table>\n"},i.prototype.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},i.prototype.tablecell=function(t,e){var n=e.header?"th":"td",s=e.align?"<"+n+' style="text-align:'+e.align+'">':"<"+n+">";return s+t+"</"+n+">\n"},i.prototype.strong=function(t){return"<strong>"+t+"</strong>"},i.prototype.em=function(t){return"<em>"+t+"</em>"},i.prototype.codespan=function(t){return"<code>"+t+"</code>"},i.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.prototype.del=function(t){return"<del>"+t+"</del>"},i.prototype.link=function(t,e,n){if(this.options.sanitize){try{var s=decodeURIComponent(a(t)).replace(/[^\w:]/g,"").toLowerCase()}catch(i){return""}if(0===s.indexOf("javascript:"))return""}var r='<a href="'+t+'"';return e&&(r+=' title="'+e+'"'),r+=">"+n+"</a>"},i.prototype.image=function(t,e,n){var s='<img src="'+t+'" alt="'+n+'"';return e&&(s+=' title="'+e+'"'),s+=this.options.xhtml?"/>":">"},r.parse=function(t,e,n){var s=new r(e,n);return s.parse(t)},r.prototype.parse=function(t){this.inline=new s(t.links,this.options,this.renderer),this.tokens=t.reverse();for(var e="";this.next();)e+=this.tok();return e},r.prototype.next=function(){return this.token=this.tokens.pop()},r.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},r.prototype.parseText=function(){for(var t=this.token.text;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)},r.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var t,e,n,s,i,r="",o="";for(n="",t=0;t<this.token.header.length;t++)s={header:!0,align:this.token.align[t]},n+=this.renderer.tablecell(this.inline.output(this.token.header[t]),{header:!0,align:this.token.align[t]});for(r+=this.renderer.tablerow(n),t=0;t<this.token.cells.length;t++){for(e=this.token.cells[t],n="",i=0;i<e.length;i++)n+=this.renderer.tablecell(this.inline.output(e[i]),{header:!1,align:this.token.align[i]});o+=this.renderer.tablerow(n)}return this.renderer.table(r,o);case"blockquote_start":for(var o="";"blockquote_end"!==this.next().type;)o+=this.tok();return this.renderer.blockquote(o);case"list_start":for(var o="",a=this.token.ordered;"list_end"!==this.next().type;)o+=this.tok();return this.renderer.list(o,a);case"list_item_start":for(var o="";"list_item_end"!==this.next().type;)o+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(o);case"loose_item_start":for(var o="";"list_item_end"!==this.next().type;)o+=this.tok();return this.renderer.listitem(o);case"html":var l=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(l);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},h.exec=h,u.options=u.setOptions=function(t){return c(u.defaults,t),u},u.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new i,xhtml:!1},u.Parser=r,u.parser=r.parse,u.Renderer=i,u.Lexer=t,u.lexer=t.lex,u.InlineLexer=s,u.inlineLexer=s.output,u.parse=u,"object"==typeof n?e.exports=u:"function"==typeof define&&define.amd?define(function(){return u}):this.marked=u}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,e){var n=window.React;e.exports=n.createClass({displayName:"exports",mixins:[t("../mixins/weblogsettings")],getInitialState:function(){return{hidden:!0,user:"",repo:"",branch:"",path:"gh-weblog",token:""}},componentDidMount:function(){var t=this.getSettings();t&&(t.hidden=this.props.hidden,this.setState(t))},render:function(){return n.createElement("div",{className:"underlay",hidden:this.state.hidden,onClick:this.close},n.createElement("div",{className:"overlay",onClick:this.stopPropagation},n.createElement("button",{className:"logout",onClick:this.reset},"Log out"),n.createElement("h1",null,"Weblog administration settings"),n.createElement("table",null,n.createElement("tr",null,n.createElement("td",null,"Your github username:"),n.createElement("td",null,n.createElement("input",{type:"text",placeholder:"yourname",value:this.state.user,onChange:this.changeUser}))),n.createElement("tr",null,n.createElement("td",null,"github repository:"),n.createElement("td",null,n.createElement("input",{type:"text",placeholder:"yourname.github.io",value:this.state.repo,onChange:this.changeRepo}))),n.createElement("tr",null,n.createElement("td",null,"repository branch:"),n.createElement("td",null,n.createElement("input",{type:"text",placeholder:"master",value:this.state.branch,onChange:this.changeBranch}))),n.createElement("tr",null,n.createElement("td",null,"path to weblog:"),n.createElement("td",null,n.createElement("input",{type:"text",value:this.state.path,onChange:this.changePath})))),n.createElement("h1",null,"Github ",n.createElement("a",{href:"https://github.com/settings/applications"},"Personal Access Token")),n.createElement("input",{type:"text",className:"token",value:this.state.token,onChange:this.changeToken}),n.createElement("p",null,"Don't give this token more permissions than necessary! gh-weblog only needs repo access!")))},reset:function(){this.clearSettings(),this.setState({user:"",repo:"",branch:"",path:"gh-weblog",token:"",hidden:!0}),this.props.onLogout()},show:function(){this.setState({hidden:!1})},close:function(){this.setState({hidden:!0}),this.props.onClose({user:this.state.user,repo:this.state.repo,branch:this.state.branch,path:this.state.path,token:this.state.token})},stopPropagation:function(t){t.stopPropagation(),t.preventDefault()},changeUser:function(t){this.setState({user:t.target.value},this.update)},changeRepo:function(t){this.setState({repo:t.target.value},this.update)},changeBranch:function(t){this.setState({branch:t.target.value},this.update)},changePath:function(t){this.setState({path:t.target.value},this.update)},changeToken:function(t){this.setState({token:t.target.value},this.update)},update:function(){this.saveSettings(this.state)}})},{"../mixins/weblogsettings":13}],4:[function(t,e){var n=window.React;e.exports=n.createClass({displayName:"exports",getInitialState:function(){return{text:""}},componentDidMount:function(){this.setState({text:this.props.text})},render:function(){return n.createElement("textarea",{ref:"textarea",className:"editor",hidden:this.props.hidden,value:this.state.text,onChange:this.record})},setText:function(t){var e=this.refs.textarea.getDOMNode();this.setState({text:t},function(){e.focus()})},record:function(t){this.setState({text:t.target.value}),this.props.update(t)},finish:function(){this.props.view()}})},{}],5:[function(t,e){var n=window.React,s=t("./MarkDown.jsx"),i=t("./Editor.jsx"),r=t("./Tags.jsx");e.exports=n.createClass({displayName:"exports",mixins:[t("react-onclickoutside")],getInitialState:function(){return{id:-1,title:"",created:Date.now(),published:Date.now(),updated:Date.now(),tags:[],editing:!1,postdata:""}},componentDidMount:function(){var t=this.props.metadata;t.postdata=this.props.postdata,this.setState(t)},render:function(){var t,e=this.getText(),o="gh-weblog-"+this.state.created,a="#"+o;this.props.editable&&(t=n.createElement("button",{className:"admin delete button",onClick:this.delete},"remove entry"));var l=new Date(this.state.published).toLocaleString(),h=new Date(this.state.updated).toLocaleString();return n.createElement("div",{className:"entry",id:o},t,n.createElement("header",null,n.createElement("h1",null,n.createElement("a",{href:a},this.state.title)),n.createElement("h2",null,"Originally posted on ",l,", last updated on ",h)),n.createElement(s,{ref:"markdown",hidden:this.state.editing,text:this.state.postdata,onClick:this.edit}),n.createElement(i,{ref:"editor",hidden:!this.state.editing,text:e,update:this.update,view:this.view,"delete":this.delete}),n.createElement("a",{className:"comments",href:this.props.issues},"leave a comment on github"),n.createElement(r,{disabled:!this.props.editable,tags:this.state.tags,onChange:this.updateTags}))},componentDidUpdate:function(){this.props.runProcessors(this.refs.markdown.getDOMNode())},handleClickOutside:function(){this.view()},updateTags:function(t){var e=this;this.setState({tags:t},function(){this.props.onSave(e)})},getText:function(){return"#"+this.state.title+"\n\n"+this.state.postdata},getMetaData:function(){var t=JSON.parse(JSON.stringify(this.state));return delete t.editing,delete t.postdata,t},getPostData:function(){return this.state.postdata},getHTMLData:function(){return this.refs.markdown.getHTML()},edit:function(){this.props.editable&&(this.refs.editor.setText(this.getText()),this.setState({editing:!0}))},update:function(t){var e=t.target.value.split("\n"),n=e.splice(0,1)[0].replace(/^#*/,""),s=e.join("\n").trim();this.setState({title:n,postdata:s,updated:Date.now()})},view:function(){this.state.editing&&(this.setState({editing:!1}),this.props.onSave(this))},"delete":function(){this.props.onDelete(this)},toRSS:function(){}})},{"./Editor.jsx":4,"./MarkDown.jsx":6,"./Tags.jsx":7,"react-onclickoutside":14}],6:[function(t,e){var n=window.React;e.exports=n.createClass({displayName:"exports",mixins:[t("../mixins/markdown")],render:function(){return this.html=this.markdown(this.props.text),n.createElement("div",n.__spread({className:"post",hidden:this.props.hidden,onClick:this.props.onClick},this.html))},getHTML:function(){return this.html.dangerouslySetInnerHTML.__html}})},{"../mixins/markdown":10}],7:[function(t,e){var n=window.React;e.exports=n.createClass({displayName:"exports",render:function(){var t=this.props.tags.map(function(t,e){return n.createElement("div",{className:"tag",key:e},t)});return n.createElement("div",{className:"tags",onClick:this.updateTags},t)},updateTags:function(){if(!this.props.disabled){var t=this.props.tags.join(", "),e=prompt("Edit the post tags",t);t=e.split(",").map(function(t){return t.trim()}),this.props.onChange(t)}}})},{}],8:[function(t,e){var n=window.React,s=t("./Admin.jsx"),i=t("./Entry.jsx");e.exports=n.createClass({displayName:"exports",mixins:[t("../mixins/connector"),t("../mixins/timetoid"),t("../mixins/rssgenerator"),t("../mixins/weblogsettings")],index:[],list:{},getInitialState:function(){return{singleton:!1,entries:this.list,slice:{start:0,end:10},githubissues:"",authenticated:!1,site:"",issues:""}},componentDidMount:function(){var t=this.getSettings();t?(this.connector=new this.Connector(t),t.token&&this.setState({authenticated:!0})):this.connector=new this.Connector;var e=window.location.hash||!1;e&&(e=e.indexOf("#gh-weblog")>-1?e.replace("#gh-weblog-",""):!1);var n=this.timeToId(e);n&&this.setState({singleton:!0}),this.connector.loadIndex(this.loadIndex,n);var s=document.createElement("a");s.href=this.props.base;var i=s.host.replace(".github.io",""),r=s.pathname.replace(/^\//,"").trim().split("/")[0],o=r?r:s.host;this.setState({site:"http://github.com/"+i+"/"+o,issues:"http://github.com/"+i+"/"+o+"/issues"})},render:function(){if(this.state.singleton)return this.renderContent();var t=this.state.authenticated?n.createElement("button",{className:"admin post button",onClick:this.create},"new entry"):!1,e=n.createElement("button",{className:"authenticate",onClick:this.showSettings,onClose:this.bindSettings},"admin"),s=n.createElement("button",{onClick:this.more},"Load more posts");return this.renderContent(e,t,s)},renderContent:function(t,e,i){return n.createElement("div",{ref:"weblog",className:"gh-weblog"},n.createElement(s,{ref:"admin",hidden:"true",onClose:this.bindSettings,onLogout:this.onLogOut}),t,e,this.generateEntries(),i)},generateEntries:function(){var t=this;return this.getSlice().map(function(e){return n.createElement(i,{key:e.metadata.created,ref:e.metadata.id,issues:t.state.issues,metadata:e.metadata,postdata:e.postdata,editable:!t.state.singleton&&t.state.authenticated,runProcessors:t.runProcessors,onSave:t.save,onDelete:t.delete})})},runProcessors:function(t){this.props.processors&&this.props.processors instanceof Array&&this.props.processors.forEach(function(e){e(t)})},showSettings:function(){this.refs.admin.show()},bindSettings:function(t){this.connector.setProperties(t),t.token.trim()&&this.setState({authenticated:!0})},onLogOut:function(){this.setState({authenticated:!1})},more:function(){this.setState({slice:{start:this.state.slice.start,end:this.state.slice.end+10}},this.loadEntries)},getSlice:function(){var t=this.list,e=this.state.slice.start,n=this.state.slice.end,s=Object.keys(t).sort().reverse().slice(e,n);return s.map(function(e){return t[e]})},loadIndex:function(t,e){this.index=e.reverse(),this.loadEntries()},loadEntries:function(){var t=this.connector,e=this.setEntry,n=this.state.slice.start,s=this.state.slice.end,i=this.index.slice(n,s),r=this.list;!function o(n){if(0!==n.length){var s=n.splice(0,1)[0];return r[s]?o(n):void t.loadMetadata(s,function(i,r){return i?(console.error("no metadata found for id: "+s+" ("+i+")"),void o(n)):void t.loadEntry(s,function(t,i){return t?(console.error("no post data found for id: "+s+" ("+t+")"),void o(n)):(e(s,r,i),void o(n))})})}}(i)},setEntry:function(t,e,n){e.id=t,-1===this.index.indexOf(t)&&this.index.push(t),this.list[t]={metadata:e,postdata:n},this.setState({entries:this.list})},create:function(){var t=new Date,e=t.getTime(),n={title:"New Entry",created:e,published:e,updated:e,tags:[]},s="...click here to start editing your post...",i=this.timeToId(e);this.setEntry(i,n,s)},save:function(t){var e=this;this.setEntry(t.state.id,t.getMetaData(),t.postdata),this.connector.saveEntry(t,this.index,function(){console.log("save handled"),e.saveRSS()})},"delete":function(t){var e=confirm("really delete post?");if(e){var n=this,s=t.state.id,i=this.index.indexOf(s);this.index.splice(i,1),delete this.list[s],this.setState({entries:this.list}),this.connector.deleteEntry(t,this.index,function(){console.log("delete handled"),n.saveRSS()})}},saveRSS:function(){var t=this,e=this.connector;console.log("Updating RSS..."),e.saveRSS(t.toRSS(),function(){if(console.log("updated."),t.props.rssfeeds){console.log("Updating category-specific RSS...");var n=t.props.rssfeeds.split(",").map(function(t){return t.trim()}).filter(function(t){return!!t});!function s(){if(0===n.length)return console.log("All RSS feeds updated");var i=n.splice(0,1)[0];console.log("Updating category "+i),e.saveRSS(t.toRSS(i),i.toLowerCase(),s)}()}})}})},{"../mixins/connector":9,"../mixins/rssgenerator":11,"../mixins/timetoid":12,"../mixins/weblogsettings":13,"./Admin.jsx":3,"./Entry.jsx":5}],9:[function(t,e){e.exports={Connector:function(){var t=function(t){t&&t.token&&t.token.trim()?(this.options=t,this.setProperties(t)):this.options={path:"gh-weblog"}};return t.prototype={setProperties:function(t){this.path=t.path;var e=new Octokit({token:t.token});this.repo=e.getRepo(t.user,t.repo),this.branch=this.repo.getBranch(t.branch)},get:function(t,e,n){e&&!n&&(n=e,e={});var s=new XMLHttpRequest,i="?cb="+Date.now();s.open("GET",t+i,!0),Object.keys(e).forEach(function(t){s[t]=e[t]}),s.onreadystatechange=function(e){if(0===s.status||200===s.status){if(4===s.readyState){var i=e.target.response;n(!i,i)}}else n("xhr error "+s.status+" for "+t,!1)},s.onerror=function(){},s.send(null)},json:function(t,e){this.get(t,{responseType:"json"},e)},loadIndex:function(t,e){this.json(this.options.path+"/content/posts/index.json",function(n,s){return e?t(n,s?[e]:!1):void t(n,s?s.index.sort():!1)})},loadMetadata:function(t,e){this.json(this.options.path+"/content/posts/metadata/"+t+".json",function(t,n){e(t,n)})},loadEntry:function(t,e){this.get(this.options.path+"/content/posts/markdown/"+t+".md",function(t,n){e(t,n)})},saveEntry:function(t,e,n){var s=t.state.id,i=this.options.path+"/content/posts/",e=JSON.stringify({index:e.sort()},!1,2),r=i+"index.json",o=JSON.stringify(t.getMetaData(),!1,2),a=i+"metadata/"+s+".json",l=t.getPostData(),h=i+"markdown/"+s+".md",c="Saving new entry "+s,u={};u[r]=e,u[a]=o,u[h]=l;try{this.branch.writeMany(u,c).then(function(){console.log("Saved entry "+s+" to github."),n&&n(t)})}catch(p){throw console.error("saving went horribly wrong"),p}},updateEntry:function(t,e){var n=t.state.id;console.log("Updating "+n);var s=this.options.path+"/content/posts/",i=JSON.stringify(t.getMetaData(),!1,2),r=s+"metadata/"+n+".json",o=t.getPostData(),a=s+"markdown/"+n+".md",l="Updating entry "+n,h={};h[r]=i,h[a]=o;try{this.branch.writeMany(h,l).then(function(){console.log("Updated entry "+n+" on github."),e&&e(t)})}catch(c){throw console.error("updating went horribly wrong"),c}},deleteEntry:function(t,e,n){var s=t.state.id;console.log("Deleting "+s);var i=this.options.path+"/content/posts/",r=i+"index.json",e=JSON.stringify({index:e.sort()},!1,2),o=i+"metadata/"+s+".json",a=i+"markdown/"+s+".md",l="Removing entry "+s,h=this.branch;try{h.write(r,e,l).then(function(){return h.remove(o,l)}).then(function(){return h.remove(a,l)}).then(function(){console.log("Removed entry "+s+" from github."),n&&n(t)})}catch(c){throw console.error("deleting went horribly wrong"),c}},saveRSS:function(t,e,n){"function"==typeof e&&(n=e,e=!1);var s=this.options.path+"/"+(e?e+"-":"")+"rss.xml",i="Update to RSS XML";try{this.branch.write(s,t,i).then(function(){console.log("Updated RSS on github."),n&&n()})}catch(r){throw console.error("updating RSS went horribly wrong"),r}}},t}()}},{}],10:[function(t,e){var n=t("../bower_components/marked/lib/marked");e.exports={markdown:function(t){return{dangerouslySetInnerHTML:{__html:n(t)}}}}},{"../bower_components/marked/lib/marked":2}],11:[function(t,e){e.exports={toRSS:function(t){var e=this,n=this.props.base;if(!(this.state.singleton||this.state.slice.start>=10)){var s=['<?xml version="1.0" encoding="UTF-8" ?>','<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">',"<channel>",'<atom:link href="'+this.props.base+"/"+this.props.path+'/rss.xml" rel="self" type="application/rss+xml" />',"<title>"+this.props.title+"</title>","<description>"+this.props.description+(t?" ["+t+" posts only]":"")+"</description>","<link>"+n+"</link>","<lastBuildDate>"+(new Date).toUTCString()+"</lastBuildDate>","<pubDate>"+(new Date).toUTCString()+"</pubDate>","<ttl>1440</ttl>"].join("\n")+"\n",i=Object.keys(this.list).sort().reverse().slice(0,10),r=i.map(function(s){var i=e.refs[s];if(t&&-1===i.state.tags.indexOf(t))return"";var r=i.getHTMLData(),o=document.createElement("div");o.textContent=r;var a=o.innerHTML,l=["<item>","<title>"+i.state.title+"</title>","<description>"+a+"</description>",i.state.tags.map(function(t){return"<category>"+t+"</category>"}).join("\n"),"<link>"+n+"/#gh-weblog-"+i.state.published+"</link>","<guid>"+n+"/#gh-weblog-"+i.state.published+"</guid>","<pubDate>"+new Date(i.state.published).toUTCString()+"</pubDate>","</item>"];return l.join("\n")}).filter(function(t){return!!t}).join("\n"),o=["</channel>","</rss>"].join("\n")+"\n",a=s+r+o;
return a}}}},{}],12:[function(t,e){e.exports={timeToId:function(t){if(!t)return!1;var e=new Date(parseInt(t,10)),n=e.toISOString(),s=n.replace("T","-").replace(/\..*/,"").replace(/\:/g,"-");return s}}},{}],13:[function(t,e){e.exports={settingsName:function(){var t=window.location.host,e=window.location.pathname;return t+=e.lastIndexOf("/")===e.length-1?e:"/","gh-weblog-settings-"+t}(),getSettings:function(){var t=window.localStorage[this.settingsName];return t?JSON.parse(t):!1},saveSettings:function(t){window.localStorage[this.settingsName]=JSON.stringify(t)},clearSettings:function(){window.localStorage.removeItem(this.settingsName)}}},{}],14:[function(t,e,n){!function(t,s){"function"==typeof define&&define.amd?define([],s):"object"==typeof n?e.exports=s():t.OnClickOutside=s()}(this,function(){"use strict";var t=[],e=[];return{componentDidMount:function(){if(!this.handleClickOutside)throw new Error("Component lacks a handleClickOutside(event) function for processing outside click events.");var n=function(t,e){return function(n){for(var s=n.target,i=!1;s.parentNode;){if(i=s===t)return;s=s.parentNode}e(n)}}(this.getDOMNode(),this.handleClickOutside);document.addEventListener("click",n);var s=t.length;t.push(this),e[s]=n},componentWillUnmount:function(){var n=t.indexOf(this);if(n>-1){var s=e[n];s&&document.removeEventListener("click",s)}}}})},{}]},{},[1]);