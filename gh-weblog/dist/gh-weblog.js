(function(){var t,e,n,r,s,i,o,a,u,l,h,c,p=this,f={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},g=[].slice;h={},h.isEmpty=function(t){return 0===Object.keys(t).length},h.isArray=Array.isArray||function(t){return"[object Array]"===toString.call(t)},h.defaults=function(t,e){var n,r,s,i,o;for(i=Object.keys(e),o=[],r=0,s=i.length;s>r;r++)n=i[r],o.push(function(n){return null!=t[n]?t[n]:t[n]=e[n]}(n));return o},h.each=function(t,e){var n,r,s,i,o,a;if(t){for(h.isArray(t)&&t.forEach(e),n=[],o=Object.keys(t),a=[],s=0,i=o.length;i>s;s++)r=o[s],a.push(function(n){return e(t[n])}(r));return a}},h.pairs=function(t){var e,n,r,s,i,o;for(e=[],o=Object.keys(t),r=function(n){return e.push([n,t[n]])},s=0,i=o.length;i>s;s++)n=o[s],r(n);return e},h.map=function(t,e){var n,r,s,i,o,a;if(h.isArray(t))return t.map(e);for(n=[],a=Object.keys(t),s=function(r){return n.push(e(t[r]))},i=0,o=a.length;o>i;i++)r=a[i],s(r);return n},h.last=function(t,e){var n;return n=t.length,t.slice(n-e,n)},h.select=function(t,e){return t.filter(e)},h.extend=function(t,e){var n,r,s,i,o;for(o=Object.keys(e),r=function(n){return t[n]=e[n]},s=0,i=o.length;i>s;s++)n=o[s],r(n);return t},h.toArray=function(t){return Array.prototype.slice.call(t)},u=function(t,e,n,r,s){var i,o,a,u;return o=function(e){return t(function(t,r){var s,i,o,a;o=new n,o.dataType=e.dataType,"function"==typeof o.overrideMimeType&&o.overrideMimeType(e.mimeType),o.open(e.type,e.url),e.data&&"GET"!==e.type&&o.setRequestHeader("Content-Type",e.contentType),a=e.headers;for(s in a)i=a[s],o.setRequestHeader(s,i);return o.onreadystatechange=function(){var n,s;return 4===o.readyState?(null!=(s=e.statusCode)&&"function"==typeof s[n=o.status]&&s[n](),o.status>=200&&o.status<300||304===o.status?t(o):r(o)):void 0},o.send(e.data)})},u=function(e){return t(function(t){return t(e)})},a=function(e){return t(function(t,n){return n(e)})},i=function(){function n(n){var i,l,c,p,f,g,m,b,v,y,k,E,w,T,S,x,R,P,C;null==n&&(n={}),h.defaults(n,{rootURL:"https://api.github.com",useETags:!0,usePostInsteadOfPatch:!1}),R=this,P=[],c=function(){function t(t,e,n){this.eTag=t,this.data=e,this.status=n}return t}(),x={},w=function(t,e){return"function"==typeof t.notify?t.notify({type:"start",path:e}):void 0},E=function(t,e){return"function"==typeof t.notify?t.notify({type:"end",path:e}):void 0},C=function(e,i,a,u){var l,p,f,d;return null==u&&(u={raw:!1,isBase64:!1,isBoolean:!1}),"PATCH"===e&&n.usePostInsteadOfPatch&&(e="POST"),/^http/.test(i)||(i=""+n.rootURL+i),f=void 0,u.isBase64&&(f="text/plain; charset=x-user-defined"),p={Accept:"application/vnd.github.raw"},s&&(p["User-Agent"]=s),i in x?p["If-None-Match"]=x[i].eTag:p["If-Modified-Since"]="Thu, 01 Jan 1970 00:00:00 GMT",(n.token||n.username&&n.password)&&(l=n.token?"token "+n.token:"Basic "+r(""+n.username+":"+n.password),p.Authorization=l),d=t(function(t,r){var s,l,d,g,m=this;return s={url:i,type:e,contentType:"application/json",mimeType:f,headers:p,processData:!1,data:!u.raw&&a&&JSON.stringify(a)||a,dataType:u.raw?void 0:"json"},u.isBoolean&&(s.statusCode={204:function(){return t(!0)},404:function(){return t(!1)}}),g=o(s),l=function(t){var n,r,s,o,l,h;for(E(m,i),r=parseFloat(t.getResponseHeader("X-RateLimit-Limit")),s=parseFloat(t.getResponseHeader("X-RateLimit-Remaining")),h=[],o=0,l=P.length;l>o;o++)n=P[o],h.push(n(s,r,e,i,a,u));return h},g.then(function(r){var o,p,f,d,g,m,b,v;if(l(r),304===r.status)return n.useETags&&x[i]?(f=x[i],t(f.data,f.status,r)):t(r.responseText,status,r);if(204===r.status&&u.isBoolean)return t(!0,status,r);if(r.responseText&&"json"===s.dataType?(a=JSON.parse(r.responseText),m={},g=r.getResponseHeader("Link"),h.each(null!=g?g.split(","):void 0,function(t){var e,n,r,s;return s=t.match(/<([^>]+)>;\ rel="([^"]+)"/),e=s[0],n=s[1],r=s[2],m[""+r+"Page"]=function(){return C("GET",n,null,u)}}),h.extend(a,m)):a=r.responseText,"GET"===e&&u.isBase64){for(o="",d=b=0,v=a.length;v>=0?v>=b:b>=v;d=v>=0?++b:--b)o+=String.fromCharCode(255&a.charCodeAt(d));a=o}return"GET"===e&&r.getResponseHeader("ETag")&&n.useETags&&(p=r.getResponseHeader("ETag"),x[i]=new c(p,a,r.status)),t(a,r.status,r)}),d=function(e){var n,s;return l(e),u.isBoolean&&404===e.status?t(!1):"application/json; charset=utf-8"!==e.getResponseHeader("Content-Type")?(n=new Error(e.responseText),n.status=e.status,n.__jqXHR=e,r(n)):(n=new Error("Github error: "+e.responseText),s=e.responseText?JSON.parse(e.responseText):"",n.error=s,n.status=e.status,n.__jqXHR=e,r(n))},("function"==typeof g["catch"]?g["catch"](d):void 0)||g.fail(d)}),w(d,i),d},S=function(t){var e;return h.isEmpty(t)?"":(e=[],h.each(h.pairs(t),function(t){var n,r;return n=t[0],r=t[1],e.push(""+n+"="+encodeURIComponent(r))}),"?"+e.join("&"))},this.clearCache=y=function(){return x={}},this.getCache=k=function(){return x},this.setCache=T=function(t){if(null===t||"object"!=typeof t)throw new Error('BUG: argument of method "setCache" should be an object');return x=t},this.onRateLimitChanged=function(t){return P.push(t)},this.getZen=function(){return C("GET","/zen",null,{raw:!0})},this.getAllUsers=function(t){var e;return null==t&&(t=null),e={},t&&(e.since=t),C("GET","/users",e)},this.getOrgRepos=function(t,e){return null==e&&(e="all"),C("GET","/orgs/"+t+"/repos?type="+e+"&per_page=1000&sort=updated&direction=desc",null)},this.getPublicGists=function(t){var e,n;return null==t&&(t=null),n=null,e=function(t){return Date===t.constructor?t.toISOString():t},t&&(n={since:e(t)}),C("GET","/gists/public",n)},this.getPublicEvents=function(){return C("GET","/events",null)},this.getNotifications=function(t){var e,n;return null==t&&(t={}),e=function(t){return Date===t.constructor?t.toISOString():t},t.since&&(t.since=e(t.since)),n=S(t),C("GET","/notifications"+n,null)},v=function(){function t(t){var e,n;null==t&&(t=null),n=t?"/users/"+t:"/user",e=null,this.getInfo=function(t){return null==t&&(t=!1),t&&(e=null),e?u(e):C("GET",""+n,null).then(function(t){return e=t})},this.getRepos=function(t,e,r){return null==t&&(t="all"),null==e&&(e="pushed"),null==r&&(r="desc"),C("GET",""+n+"/repos?type="+t+"&per_page=1000&sort="+e+"&direction="+r,null)},this.getOrgs=function(){return C("GET",""+n+"/orgs",null)},this.getGists=function(){return C("GET",""+n+"/gists",null)},this.getFollowers=function(){return C("GET",""+n+"/followers",null)},this.getFollowing=function(){return C("GET",""+n+"/following",null)},this.isFollowing=function(t){return C("GET",""+n+"/following/"+t,null,{isBoolean:!0})},this.getPublicKeys=function(){return C("GET",""+n+"/keys",null)},this.getReceivedEvents=function(e){var n;if(!t)throw new Error("BUG: This does not work for authenticated users yet!");return n="",e&&(n="/public"),C("GET","/users/"+t+"/received_events"+n,null)},this.getEvents=function(e){var n;if(!t)throw new Error("BUG: This does not work for authenticated users yet!");return n="",e&&(n="/public"),C("GET","/users/"+t+"/events"+n,null)}}return t}(),i=function(t){function e(){e.__super__.constructor.call(this),this.updateInfo=function(t){return C("PATCH","/user",t)},this.getGists=function(){return C("GET","/gists",null)},this.follow=function(t){return C("PUT","/user/following/"+t,null)},this.unfollow=function(t){return C("DELETE","/user/following/"+t,null)},this.getEmails=function(){return C("GET","/user/emails",null)},this.addEmail=function(t){return h.isArray(t)||(t=[t]),C("POST","/user/emails",t)},this.addEmail=function(t){return h.isArray(t)||(t=[t]),C("DELETE","/user/emails",t)},this.getPublicKey=function(t){return C("GET","/user/keys/"+t,null)},this.addPublicKey=function(t,e){return C("POST","/user/keys",{title:t,key:e})},this.updatePublicKey=function(t,e){return C("PATCH","/user/keys/"+t,e)},this.createRepo=function(t,e){return null==e&&(e={}),e.name=t,C("POST","/user/repos",e)},this.getReceivedEvents=function(t,e){var n;return null==e&&(e=1),n="?page="+e,C("GET","/users/"+t+"/received_events"+n,null)},this.getStars=function(){return C("GET","/user/starred")},this.putStar=function(t,e){return C("PUT","/user/starred/"+t+"/"+e)},this.deleteStar=function(t,e){return C("DELETE","/user/starred/"+t+"/"+e)}}return d(e,t),e}(v),b=function(){function t(t){this.id=t,this.getInfo=function(){return C("GET","/teams/"+this.id,null)},this.updateTeam=function(t){return C("PATCH","/teams/"+this.id,t)},this.remove=function(){return C("DELETE","/teams/"+this.id)},this.getMembers=function(){return C("GET","/teams/"+this.id+"/members")},this.isMember=function(t){return C("GET","/teams/"+this.id+"/members/"+t,null,{isBoolean:!0})},this.addMember=function(t){return C("PUT","/teams/"+this.id+"/members/"+t)},this.removeMember=function(t){return C("DELETE","/teams/"+this.id+"/members/"+t)},this.getRepos=function(){return C("GET","/teams/"+this.id+"/repos")},this.addRepo=function(t,e){return C("PUT","/teams/"+this.id+"/repos/"+t+"/"+e)},this.removeRepo=function(t,e){return C("DELETE","/teams/"+this.id+"/repos/"+t+"/"+e)}}return t}(),g=function(){function t(t){this.name=t,this.getInfo=function(){return C("GET","/orgs/"+this.name,null)},this.updateInfo=function(t){return C("PATCH","/orgs/"+this.name,t)},this.getTeams=function(){return C("GET","/orgs/"+this.name+"/teams",null)},this.createTeam=function(t,e,n){var r;return null==e&&(e=null),null==n&&(n="pull"),r={name:t,permission:n},e&&(r.repo_names=e),C("POST","/orgs/"+this.name+"/teams",r)},this.getMembers=function(){return C("GET","/orgs/"+this.name+"/members",null)},this.isMember=function(t){return C("GET","/orgs/"+this.name+"/members/"+t,null,{isBoolean:!0})},this.removeMember=function(t){return C("DELETE","/orgs/"+this.name+"/members/"+t,null)},this.createRepo=function(t,e){return null==e&&(e={}),e.name=t,C("POST","/orgs/"+this.name+"/repos",e)},this.getRepos=function(){return C("GET","/orgs/"+this.name+"/repos?type=all",null)}}return t}(),f=function(){function t(t,e){var n;this.repoUser=t,this.repoName=e,n="/repos/"+this.repoUser+"/"+this.repoName,this.deleteRepo=function(){return C("DELETE",""+n)},this._updateTree=function(t){return this.getRef("heads/"+t)},this.getRef=function(t){return C("GET",""+n+"/git/refs/"+t,null).then(function(t){return t.object.sha})},this.createRef=function(t){return C("POST",""+n+"/git/refs",t)},this.deleteRef=function(t){return C("DELETE",""+n+"/git/refs/"+t,this.options)},this.getBranches=function(){return C("GET",""+n+"/git/refs/heads",null).then(function(t){return h.map(t,function(t){return h.last(t.ref.split("/"))})})},this.getBlob=function(t,e){return C("GET",""+n+"/git/blobs/"+t,null,{raw:!0,isBase64:e})},this.getSha=function(t,e){return""===e?this.getRef("heads/"+t):this.getTree(t,{recursive:!0}).then(function(t){var n;return n=h.select(t,function(t){return t.path===e})[0],(null!=n?n.sha:void 0)?null!=n?n.sha:void 0:a({message:"SHA_NOT_FOUND"})})},this.getContents=function(t,e){var r;return null==e&&(e=null),r="",null!==e&&(r=S({ref:e})),C("GET",""+n+"/contents/"+t+r,null,{raw:!0}).then(function(t){return t})},this.removeFile=function(t,e,r,s){var i;return i={message:e,sha:r,branch:s},C("DELETE",""+n+"/contents/"+t,i,null)},this.getTree=function(t,e){var r;return null==e&&(e=null),r=S(e),C("GET",""+n+"/git/trees/"+t+r,null).then(function(t){return t.tree})},this.postBlob=function(t,e){return"string"==typeof t&&(e&&(t=r(t)),t={content:t,encoding:"utf-8"}),e&&(t.encoding="base64"),C("POST",""+n+"/git/blobs",t).then(function(t){return t.sha})},this.updateTreeMany=function(t,e){var r;return r={base_tree:t,tree:e},C("POST",""+n+"/git/trees",r).then(function(t){return t.sha})},this.postTree=function(t){return C("POST",""+n+"/git/trees",{tree:t}).then(function(t){return t.sha})},this.commit=function(t,e,r){var s;return h.isArray(t)||(t=[t]),s={message:r,parents:t,tree:e},C("POST",""+n+"/git/commits",s).then(function(t){return t.sha})},this.updateHead=function(t,e,r){var s;return null==r&&(r=!1),s={sha:e},r&&(s.force=!0),C("PATCH",""+n+"/git/refs/heads/"+t,s)},this.getCommit=function(t){return C("GET",""+n+"/commits/"+t,null)},this.getCommits=function(t){var e,r;return null==t&&(t={}),t=h.extend({},t),e=function(t){return Date===t.constructor?t.toISOString():t},t.since&&(t.since=e(t.since)),t.until&&(t.until=e(t.until)),r=S(t),C("GET",""+n+"/commits"+r,null)}}return t}(),l=function(){function t(t,n){var r,s;s=t,r=n||function(){throw new Error("BUG: No way to fetch branch ref!")},this.getCommit=function(t){return s.getCommit(t)},this.getCommits=function(t){return null==t&&(t={}),t=h.extend({},t),r().then(function(e){return t.sha=e,s.getCommits(t)})},this.createBranch=function(t){return r().then(function(e){return s.getSha(e,"").then(function(e){return s.createRef({sha:e,ref:"refs/heads/"+t})})})},this.read=function(t,e){return r().then(function(n){return s.getSha(n,t).then(function(t){return s.getBlob(t,e).then(function(e){return{sha:t,content:e}})})})},this.contents=function(t){return r().then(function(e){return s.getSha(e,"").then(function(e){return s.getContents(t,e).then(function(t){return t})})})},this.remove=function(t,e,n){return null==e&&(e="Removed "+t),null==n&&(n=null),r().then(function(r){return n?s.removeFile(t,e,n,r):s.getSha(r,t).then(function(n){return s.removeFile(t,e,n,r)})})},this.move=function(t,e,n){return null==n&&(n="Moved "+t),r().then(function(r){return s._updateTree(r).then(function(i){return s.getTree(i,{recursive:!0}).then(function(o){return h.each(o,function(n){return n.path===t&&(n.path=e),"tree"===n.type?delete n.sha:void 0}),s.postTree(o).then(function(t){return s.commit(i,t,n).then(function(t){return s.updateHead(r,t).then(function(t){return t})})})})})})},this.write=function(t,e,n,r,s){var i;return null==n&&(n="Changed "+t),null==s&&(s=null),i={},i[t]={content:e,isBase64:r},this.writeMany(i,n,s)},this.writeMany=function(t,n,i){return null==n&&(n="Changed Multiple"),null==i&&(i=null),r().then(function(r){var o;return o=function(i){var o;return o=h.map(h.pairs(t),function(t){var e,n,r,i;return i=t[0],n=t[1],e=n.content||n,r=n.isBase64||!1,s.postBlob(e,r).then(function(t){return{path:i,mode:"100644",type:"blob",sha:t}})}),e(o).then(function(t){return s.updateTreeMany(i,t).then(function(t){return s.commit(i,t,n).then(function(t){return s.updateHead(r,t).then(function(t){return t.object})})})})},i?o(i):s._updateTree(r).then(o)})}}return t}(),m=function(){function t(t){var e,r;this.options=t,r=this.options.user,e=this.options.name,this.git=new f(r,e),this.repoPath="/repos/"+r+"/"+e,this.currentTree={branch:null,sha:null},this.updateInfo=function(t){return C("PATCH",this.repoPath,t)},this.getBranches=function(){return this.git.getBranches()},this.getBranch=function(t){var e;return null==t&&(t=null),t?(e=function(){return u(t)},new l(this.git,e)):this.getDefaultBranch()},this.getDefaultBranch=function(){var t,e=this;return t=function(){return e.getInfo().then(function(t){return t.default_branch})},new l(this.git,t)},this.setDefaultBranch=function(t){return this.updateInfo({name:e,default_branch:t})},this.getInfo=function(){return C("GET",this.repoPath,null)},this.getContents=function(t,e){return C("GET",""+this.repoPath+"/contents?ref="+t,{path:e})},this.fork=function(t){return t?C("POST",""+this.repoPath+"/forks",{organization:t}):C("POST",""+this.repoPath+"/forks",null)},this.createPullRequest=function(t){return C("POST",""+this.repoPath+"/pulls",t)},this.getCommits=function(t){return this.git.getCommits(t)},this.getEvents=function(){return C("GET",""+this.repoPath+"/events",null)},this.getIssueEvents=function(){return C("GET",""+this.repoPath+"/issues/events",null)},this.getNetworkEvents=function(){return C("GET","/networks/"+r+"/"+e+"/events",null)},this.getNotifications=function(t){var e,n;return null==t&&(t={}),e=function(t){return Date===t.constructor?t.toISOString():t},t.since&&(t.since=e(t.since)),n=S(t),C("GET",""+this.repoPath+"/notifications"+n,null)},this.getCollaborators=function(){return C("GET",""+this.repoPath+"/collaborators",null)},this.addCollaborator=function(t){if(!t)throw new Error("BUG: username is required");return C("PUT",""+this.repoPath+"/collaborators/"+t,null,{isBoolean:!0})},this.removeCollaborator=function(t){if(!t)throw new Error("BUG: username is required");return C("DELETE",""+this.repoPath+"/collaborators/"+t,null,{isBoolean:!0})},this.isCollaborator=function(t){if(null==t&&(t=null),!t)throw new Error("BUG: username is required");return C("GET",""+this.repoPath+"/collaborators/"+t,null,{isBoolean:!0})},this.canCollaborate=function(){var t=this;return n.password||n.token?R.getLogin().then(function(e){return e?t.isCollaborator(e):!1}).then(null,function(){return!1}):u(!1)},this.getHooks=function(){return C("GET",""+this.repoPath+"/hooks",null)},this.getHook=function(t){return C("GET",""+this.repoPath+"/hooks/"+t,null)},this.createHook=function(t,e,n,r){var s;return null==n&&(n=["push"]),null==r&&(r=!0),s={name:t,config:e,events:n,active:r},C("POST",""+this.repoPath+"/hooks",s)},this.editHook=function(t,e,n,r,s,i){var o;return null==e&&(e=null),null==n&&(n=null),null==r&&(r=null),null==s&&(s=null),null==i&&(i=null),o={},null!==e&&(o.config=e),null!==n&&(o.events=n),null!==r&&(o.add_events=r),null!==s&&(o.remove_events=s),null!==i&&(o.active=i),C("PATCH",""+this.repoPath+"/hooks/"+t,o)},this.testHook=function(t){return C("POST",""+this.repoPath+"/hooks/"+t+"/tests",null)},this.deleteHook=function(t){return C("DELETE",""+this.repoPath+"/hooks/"+t,null)},this.getLanguages=function(){return C("GET",""+this.repoPath+"/languages",null)},this.getReleases=function(){return C("GET",""+this.repoPath+"/releases",null)}}return t}(),p=function(){function t(t){var e,n;this.options=t,e=this.options.id,n="/gists/"+e,this.read=function(){return C("GET",n,null)},this.create=function(e,n,r){return null==n&&(n=!1),null==r&&(r=null),t={isPublic:n,files:e},null!=r&&(t.description=r),C("POST","/gists",t)},this["delete"]=function(){return C("DELETE",n,null)},this.fork=function(){return C("POST",""+n+"/forks",null)},this.update=function(e,r){return null==r&&(r=null),t={files:e},null!=r&&(t.description=r),C("PATCH",n,t)},this.star=function(){return C("PUT",""+n+"/star")},this.unstar=function(){return C("DELETE",""+n+"/star")},this.isStarred=function(){return C("GET",""+n,null,{isBoolean:!0})}}return t}(),this.getRepo=function(t,e){if(!t)throw new Error("BUG! user argument is required");if(!e)throw new Error("BUG! repo argument is required");return new m({user:t,name:e})},this.getOrg=function(t){return new g(t)},this.getUser=function(t){return null==t&&(t=null),t?new v(t):n.password||n.token?new i:null},this.getGist=function(t){return new p({id:t})},this.getLogin=function(){return n.password||n.token?(new v).getInfo().then(function(t){return t.login}):u(null)}}return n}()},"undefined"!=typeof exports&&null!==exports?(e=this.Promise||require("es6-promise").Promise,n=this.XMLHttpRequest||require("xmlhttprequest").XMLHttpRequest,l=function(t){return new e(t)},r=function(t){return e.all.call(e,t)},i=this.btoa||function(t){var e;return e=new Buffer(t,"binary"),e.toString("base64")},t=u(l,r,n,i,"octokit"),exports["new"]=function(e){return new t(e)}):(s=function(e,n){return null!=p.define?p.define("octokit",[],function(){return u(e,n,p.XMLHttpRequest,p.btoa)}):(t=u(e,n,p.XMLHttpRequest,p.btoa),p.Octokit=t,p.Github=t)},this.Q?(l=function(t){var e,n,r;return e=p.Q.defer(),r=function(t){return e.resolve(t)},n=function(t){return e.reject(t)},t(r,n),e.promise},r=function(t){return this.Q.all(t)},s(l,r)):this.angular?(a=angular.injector(["ng"]),a.invoke(function(t){return l=function(e){var n,r,s;return n=t.defer(),s=function(t){return n.resolve(t)},r=function(t){return n.reject(t)},e(s,r),n.promise},r=function(e){return t.all(e)},s(l,r)})):(null!=(c=this.jQuery)?c.Deferred:void 0)?(l=function(t){var e,n,r;return e=p.jQuery.Deferred(),r=function(t){return e.resolve(t)},n=function(t){return e.reject(t)},t(r,n),e.promise()},r=function(t){var e;return(e=p.jQuery).when.apply(e,t).then(function(){var t;return t=1<=arguments.length?g.call(arguments,0):[]})},s(l,r)):this.Promise?(l=function(t){return new p.Promise(function(e){return e.fulfill?t(e.resolve.bind(e),e.reject.bind(e)):t.apply(null,arguments)})},r=function(t){return p.Promise.all.call(p.Promise,t)},s(l,r)):(o=function(t){throw"undefined"!=typeof console&&null!==console&&"function"==typeof console.error&&console.error(t),new Error(t)})("A Promise API was not found. Supported libraries that have Promises are jQuery, angularjs, and https://github.com/jakearchibald/es6-promise"))}).call(this),function(){function t(t){this.tokens=[],this.tokens.links={},this.options=t||l.defaults,this.rules=h.normal,this.options.gfm&&(this.rules=this.options.tables?h.tables:h.gfm)}function e(t,e){if(this.options=e||l.defaults,this.links=t,this.rules=c.normal,this.renderer=this.options.renderer||new n,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.rules=this.options.breaks?c.breaks:c.gfm:this.options.pedantic&&(this.rules=c.pedantic)}function n(t){this.options=t||{}}function r(t){this.tokens=[],this.token=null,this.options=t||l.defaults,this.options.renderer=this.options.renderer||new n,this.renderer=this.options.renderer,this.renderer.options=this.options}function s(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function i(t){return t.replace(/&([#\w]+);/g,function(t,e){return e=e.toLowerCase(),"colon"===e?":":"#"===e.charAt(0)?String.fromCharCode("x"===e.charAt(1)?parseInt(e.substring(2),16):+e.substring(1)):""})}function o(t,e){return t=t.source,e=e||"",function n(r,s){return r?(s=s.source||s,s=s.replace(/(^|[^\[])\^/g,"$1"),t=t.replace(r,s),n):new RegExp(t,e)}}function a(){}function u(t){for(var e,n,r=1;r<arguments.length;r++){e=arguments[r];for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}function l(e,n,i){if(i||"function"==typeof n){i||(i=n,n=null),n=u({},l.defaults,n||{});var o,a,h=n.highlight,c=0;try{o=t.lex(e,n)}catch(p){return i(p)}a=o.length;var f=function(){var t,e;try{t=r.parse(o,n)}catch(s){e=s}return n.highlight=h,e?i(e):i(null,t)};if(!h||h.length<3)return f();if(delete n.highlight,!a)return f();for(;c<o.length;c++)!function(t){return"code"!==t.type?--a||f():h(t.text,t.lang,function(e,n){return null==n||n===t.text?--a||f():(t.text=n,t.escaped=!0,void(--a||f()))})}(o[c])}else try{return n&&(n=u({},l.defaults,n)),r.parse(t.lex(e,n),n)}catch(p){if(p.message+="\nPlease report this to https://github.com/chjj/marked.",(n||l.defaults).silent)return"<p>An error occured:</p><pre>"+s(p.message+"",!0)+"</pre>";throw p}}var h={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:a,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:a,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:a,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};h.bullet=/(?:[*+-]|\d+\.)/,h.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,h.item=o(h.item,"gm")(/bull/g,h.bullet)(),h.list=o(h.list)(/bull/g,h.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+h.def.source+")")(),h.blockquote=o(h.blockquote)("def",h.def)(),h._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",h.html=o(h.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,h._tag)(),h.paragraph=o(h.paragraph)("hr",h.hr)("heading",h.heading)("lheading",h.lheading)("blockquote",h.blockquote)("tag","<"+h._tag)("def",h.def)(),h.normal=u({},h),h.gfm=u({},h.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/}),h.gfm.paragraph=o(h.paragraph)("(?!","(?!"+h.gfm.fences.source.replace("\\1","\\2")+"|"+h.list.source.replace("\\1","\\3")+"|")(),h.tables=u({},h.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=h,t.lex=function(e,n){var r=new t(n);return r.lex(e)},t.prototype.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(t,!0)},t.prototype.token=function(t,e,n){for(var r,s,i,o,a,u,l,c,p,t=t.replace(/^ +$/gm,"");t;)if((i=this.rules.newline.exec(t))&&(t=t.substring(i[0].length),i[0].length>1&&this.tokens.push({type:"space"})),i=this.rules.code.exec(t))t=t.substring(i[0].length),i=i[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?i:i.replace(/\n+$/,"")});else if(i=this.rules.fences.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"code",lang:i[2],text:i[3]});else if(i=this.rules.heading.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"heading",depth:i[1].length,text:i[2]});else if(e&&(i=this.rules.nptable.exec(t))){for(t=t.substring(i[0].length),u={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/\n$/,"").split("\n")},c=0;c<u.align.length;c++)u.align[c]=/^ *-+: *$/.test(u.align[c])?"right":/^ *:-+: *$/.test(u.align[c])?"center":/^ *:-+ *$/.test(u.align[c])?"left":null;for(c=0;c<u.cells.length;c++)u.cells[c]=u.cells[c].split(/ *\| */);this.tokens.push(u)}else if(i=this.rules.lheading.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"heading",depth:"="===i[2]?1:2,text:i[1]});else if(i=this.rules.hr.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"hr"});else if(i=this.rules.blockquote.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"blockquote_start"}),i=i[0].replace(/^ *> ?/gm,""),this.token(i,e,!0),this.tokens.push({type:"blockquote_end"});else if(i=this.rules.list.exec(t)){for(t=t.substring(i[0].length),o=i[2],this.tokens.push({type:"list_start",ordered:o.length>1}),i=i[0].match(this.rules.item),r=!1,p=i.length,c=0;p>c;c++)u=i[c],l=u.length,u=u.replace(/^ *([*+-]|\d+\.) +/,""),~u.indexOf("\n ")&&(l-=u.length,u=this.options.pedantic?u.replace(/^ {1,4}/gm,""):u.replace(new RegExp("^ {1,"+l+"}","gm"),"")),this.options.smartLists&&c!==p-1&&(a=h.bullet.exec(i[c+1])[0],o===a||o.length>1&&a.length>1||(t=i.slice(c+1).join("\n")+t,c=p-1)),s=r||/\n\n(?!\s*$)/.test(u),c!==p-1&&(r="\n"===u.charAt(u.length-1),s||(s=r)),this.tokens.push({type:s?"loose_item_start":"list_item_start"}),this.token(u,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(i=this.rules.html.exec(t))t=t.substring(i[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:"pre"===i[1]||"script"===i[1]||"style"===i[1],text:i[0]});else if(!n&&e&&(i=this.rules.def.exec(t)))t=t.substring(i[0].length),this.tokens.links[i[1].toLowerCase()]={href:i[2],title:i[3]};else if(e&&(i=this.rules.table.exec(t))){for(t=t.substring(i[0].length),u={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/(?: *\| *)?\n$/,"").split("\n")},c=0;c<u.align.length;c++)u.align[c]=/^ *-+: *$/.test(u.align[c])?"right":/^ *:-+: *$/.test(u.align[c])?"center":/^ *:-+ *$/.test(u.align[c])?"left":null;for(c=0;c<u.cells.length;c++)u.cells[c]=u.cells[c].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(u)}else if(e&&(i=this.rules.paragraph.exec(t)))t=t.substring(i[0].length),this.tokens.push({type:"paragraph",text:"\n"===i[1].charAt(i[1].length-1)?i[1].slice(0,-1):i[1]});else if(i=this.rules.text.exec(t))t=t.substring(i[0].length),this.tokens.push({type:"text",text:i[0]});else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0));return this.tokens};var c={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:a,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:a,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};c._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,c._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,c.link=o(c.link)("inside",c._inside)("href",c._href)(),c.reflink=o(c.reflink)("inside",c._inside)(),c.normal=u({},c),c.pedantic=u({},c.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),c.gfm=u({},c.normal,{escape:o(c.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:o(c.text)("]|","~]|")("|","|https?://|")()}),c.breaks=u({},c.gfm,{br:o(c.br)("{2,}","*")(),text:o(c.gfm.text)("{2,}","*")()}),e.rules=c,e.output=function(t,n,r){var s=new e(n,r);return s.output(t)},e.prototype.output=function(t){for(var e,n,r,i,o="";t;)if(i=this.rules.escape.exec(t))t=t.substring(i[0].length),o+=i[1];else if(i=this.rules.autolink.exec(t))t=t.substring(i[0].length),"@"===i[2]?(n=this.mangle(":"===i[1].charAt(6)?i[1].substring(7):i[1]),r=this.mangle("mailto:")+n):(n=s(i[1]),r=n),o+=this.renderer.link(r,null,n);else if(this.inLink||!(i=this.rules.url.exec(t))){if(i=this.rules.tag.exec(t))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),t=t.substring(i[0].length),o+=this.options.sanitize?s(i[0]):i[0];else if(i=this.rules.link.exec(t))t=t.substring(i[0].length),this.inLink=!0,o+=this.outputLink(i,{href:i[2],title:i[3]}),this.inLink=!1;else if((i=this.rules.reflink.exec(t))||(i=this.rules.nolink.exec(t))){if(t=t.substring(i[0].length),e=(i[2]||i[1]).replace(/\s+/g," "),e=this.links[e.toLowerCase()],!e||!e.href){o+=i[0].charAt(0),t=i[0].substring(1)+t;continue}this.inLink=!0,o+=this.outputLink(i,e),this.inLink=!1}else if(i=this.rules.strong.exec(t))t=t.substring(i[0].length),o+=this.renderer.strong(this.output(i[2]||i[1]));else if(i=this.rules.em.exec(t))t=t.substring(i[0].length),o+=this.renderer.em(this.output(i[2]||i[1]));else if(i=this.rules.code.exec(t))t=t.substring(i[0].length),o+=this.renderer.codespan(s(i[2],!0));else if(i=this.rules.br.exec(t))t=t.substring(i[0].length),o+=this.renderer.br();else if(i=this.rules.del.exec(t))t=t.substring(i[0].length),o+=this.renderer.del(this.output(i[1]));else if(i=this.rules.text.exec(t))t=t.substring(i[0].length),o+=s(this.smartypants(i[0]));else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0))}else t=t.substring(i[0].length),n=s(i[1]),r=n,o+=this.renderer.link(r,null,n);return o},e.prototype.outputLink=function(t,e){var n=s(e.href),r=e.title?s(e.title):null;return"!"!==t[0].charAt(0)?this.renderer.link(n,r,this.output(t[1])):this.renderer.image(n,r,s(t[1]))},e.prototype.smartypants=function(t){return this.options.smartypants?t.replace(/--/g,"—").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):t},e.prototype.mangle=function(t){for(var e,n="",r=t.length,s=0;r>s;s++)e=t.charCodeAt(s),Math.random()>.5&&(e="x"+e.toString(16)),n+="&#"+e+";";return n},n.prototype.code=function(t,e,n){if(this.options.highlight){var r=this.options.highlight(t,e);null!=r&&r!==t&&(n=!0,t=r)}return e?'<pre><code class="'+this.options.langPrefix+s(e,!0)+'">'+(n?t:s(t,!0))+"\n</code></pre>\n":"<pre><code>"+(n?t:s(t,!0))+"\n</code></pre>"},n.prototype.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},n.prototype.html=function(t){return t},n.prototype.heading=function(t,e,n){return"<h"+e+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+t+"</h"+e+">\n"
},n.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},n.prototype.list=function(t,e){var n=e?"ol":"ul";return"<"+n+">\n"+t+"</"+n+">\n"},n.prototype.listitem=function(t){return"<li>"+t+"</li>\n"},n.prototype.paragraph=function(t){return"<p>"+t+"</p>\n"},n.prototype.table=function(t,e){return"<table>\n<thead>\n"+t+"</thead>\n<tbody>\n"+e+"</tbody>\n</table>\n"},n.prototype.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},n.prototype.tablecell=function(t,e){var n=e.header?"th":"td",r=e.align?"<"+n+' style="text-align:'+e.align+'">':"<"+n+">";return r+t+"</"+n+">\n"},n.prototype.strong=function(t){return"<strong>"+t+"</strong>"},n.prototype.em=function(t){return"<em>"+t+"</em>"},n.prototype.codespan=function(t){return"<code>"+t+"</code>"},n.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},n.prototype.del=function(t){return"<del>"+t+"</del>"},n.prototype.link=function(t,e,n){if(this.options.sanitize){try{var r=decodeURIComponent(i(t)).replace(/[^\w:]/g,"").toLowerCase()}catch(s){return""}if(0===r.indexOf("javascript:"))return""}var o='<a href="'+t+'"';return e&&(o+=' title="'+e+'"'),o+=">"+n+"</a>"},n.prototype.image=function(t,e,n){var r='<img src="'+t+'" alt="'+n+'"';return e&&(r+=' title="'+e+'"'),r+=this.options.xhtml?"/>":">"},r.parse=function(t,e,n){var s=new r(e,n);return s.parse(t)},r.prototype.parse=function(t){this.inline=new e(t.links,this.options,this.renderer),this.tokens=t.reverse();for(var n="";this.next();)n+=this.tok();return n},r.prototype.next=function(){return this.token=this.tokens.pop()},r.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},r.prototype.parseText=function(){for(var t=this.token.text;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)},r.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var t,e,n,r,s,i="",o="";for(n="",t=0;t<this.token.header.length;t++)r={header:!0,align:this.token.align[t]},n+=this.renderer.tablecell(this.inline.output(this.token.header[t]),{header:!0,align:this.token.align[t]});for(i+=this.renderer.tablerow(n),t=0;t<this.token.cells.length;t++){for(e=this.token.cells[t],n="",s=0;s<e.length;s++)n+=this.renderer.tablecell(this.inline.output(e[s]),{header:!1,align:this.token.align[s]});o+=this.renderer.tablerow(n)}return this.renderer.table(i,o);case"blockquote_start":for(var o="";"blockquote_end"!==this.next().type;)o+=this.tok();return this.renderer.blockquote(o);case"list_start":for(var o="",a=this.token.ordered;"list_end"!==this.next().type;)o+=this.tok();return this.renderer.list(o,a);case"list_item_start":for(var o="";"list_item_end"!==this.next().type;)o+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(o);case"loose_item_start":for(var o="";"list_item_end"!==this.next().type;)o+=this.tok();return this.renderer.listitem(o);case"html":var u=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(u);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},a.exec=a,l.options=l.setOptions=function(t){return u(l.defaults,t),l},l.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new n,xhtml:!1},l.Parser=r,l.parser=r.parse,l.Renderer=n,l.Lexer=t,l.lexer=t.lex,l.InlineLexer=e,l.inlineLexer=e.output,l.parse=l,"object"==typeof exports?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):this.marked=l}.call(function(){return this||("undefined"!=typeof window?window:global)}());var ConnectorMixin={Connector:function(){var t=function(t){t&&t.token&&t.token.trim()?(this.options=t,this.setProperties(t)):this.options={path:"gh-weblog"}};return t.prototype={setProperties:function(t){this.path=t.path;var e=new Octokit({token:t.token});this.repo=e.getRepo(t.user,t.repo),this.branch=this.repo.getBranch(t.branch)},get:function(t,e,n){e&&!n&&(n=e,e={});var r=new XMLHttpRequest,s="?cb="+Date.now();r.open("GET",t+s,!0),Object.keys(e).forEach(function(t){r[t]=e[t]}),r.onreadystatechange=function(e){if(0===r.status||200===r.status){if(4===r.readyState){var s=e.target.response;n(!s,s)}}else n("xhr error "+r.status+" for "+t,!1)},r.onerror=function(){},r.send(null)},json:function(t,e){this.get(t,{responseType:"json"},e)},loadIndex:function(t,e){this.json(this.options.path+"/content/posts/index.json",function(n,r){return e?t(n,r?[e]:!1):void t(n,r?r.index.sort():!1)})},loadMetadata:function(t,e){this.json(this.options.path+"/content/posts/metadata/"+t+".json",function(t,n){e(t,n)})},loadEntry:function(t,e){this.get(this.options.path+"/content/posts/markdown/"+t+".md",function(t,n){e(t,n)})},saveEntry:function(t,e,n){var r=t.state.id,s=this.options.path+"/content/posts/",e=JSON.stringify({index:e.sort()},!1,2),i=s+"index.json",o=JSON.stringify(t.getMetaData(),!1,2),a=s+"metadata/"+r+".json",u=t.getPostData(),l=s+"markdown/"+r+".md",h="Saving new entry "+r,c={};c[i]=e,c[a]=o,c[l]=u;try{this.branch.writeMany(c,h).then(function(){console.log("Saved entry "+r+" to github."),n&&n(t)})}catch(p){throw console.error("saving went horribly wrong"),p}},updateEntry:function(t,e){var n=t.state.id;console.log("Updating "+n);var r=this.options.path+"/content/posts/",s=JSON.stringify(t.getMetaData(),!1,2),i=r+"metadata/"+n+".json",o=t.getPostData(),a=r+"markdown/"+n+".md",u="Updating entry "+n,l={};l[i]=s,l[a]=o;try{this.branch.writeMany(l,u).then(function(){console.log("Updated entry "+n+" on github."),e&&e(t)})}catch(h){throw console.error("updating went horribly wrong"),h}},deleteEntry:function(t,e,n){var r=t.state.id;console.log("Deleting "+r);var s=this.options.path+"/content/posts/",i=s+"index.json",e=JSON.stringify({index:e.sort()},!1,2),o=s+"metadata/"+r+".json",a=s+"markdown/"+r+".md",u="Removing entry "+r,l=this.branch;try{l.write(i,e,u).then(function(){return l.remove(o,u)}).then(function(){return l.remove(a,u)}).then(function(){console.log("Removed entry "+r+" from github."),n&&n(t)})}catch(h){throw console.error("deleting went horribly wrong"),h}},saveRSS:function(t,e,n){"function"==typeof e&&(n=e,e=!1);var r=this.options.path+"/"+(e?e+"-":"")+"rss.xml",s="Update to RSS XML";try{this.branch.write(r,t,s).then(function(){console.log("Updated RSS on github."),n&&n()})}catch(i){throw console.error("updating RSS went horribly wrong"),i}}},t}()},MarkDownMixin={markdown:function(t){return{dangerouslySetInnerHTML:{__html:marked(t)}}}},OnClickOutside={registerOutsideClickListener:function(t){if(t){var e=this.getDOMNode();document.addEventListener("click",function(n){for(var r=n.target,s=!1;r.parentNode;){if(s=r===e)return;r=r.parentNode}t(n)})}}},RSSGenerator={toRSS:function(t){var e=this,n=this.props.base;if(!(this.state.singleton||this.state.slice.start>=10)){var r=['<?xml version="1.0" encoding="UTF-8" ?>','<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">',"<channel>",'<atom:link href="'+this.props.base+"/"+this.props.path+'/rss.xml" rel="self" type="application/rss+xml" />',"<title>"+this.props.title+"</title>","<description>"+this.props.description+(t?" ["+t+" posts only]":"")+"</description>","<link>"+n+"</link>","<lastBuildDate>"+(new Date).toUTCString()+"</lastBuildDate>","<pubDate>"+(new Date).toUTCString()+"</pubDate>","<ttl>1440</ttl>"].join("\n")+"\n",s=Object.keys(this.list).sort().reverse().slice(0,10),i=s.map(function(r){var s=e.refs[r];if(t&&-1===s.state.tags.indexOf(t))return"";var i=s.getHTMLData(),o=document.createElement("div");o.textContent=i;var a=o.innerHTML,u=["<item>","<title>"+s.state.title+"</title>","<description>"+a+"</description>",s.state.tags.map(function(t){return"<category>"+t+"</category>"}).join("\n"),"<link>"+n+"/#gh-weblog-"+s.state.published+"</link>","<guid>"+n+"/#gh-weblog-"+s.state.published+"</guid>","<pubDate>"+new Date(s.state.published).toUTCString()+"</pubDate>","</item>"];return u.join("\n")}).filter(function(t){return!!t}).join("\n"),o=["</channel>","</rss>"].join("\n")+"\n",a=r+i+o;return a}}},TimeToId={timeToId:function(t){if(!t)return!1;var e=new Date(parseInt(t,10)),n=e.toISOString(),r=n.replace("T","-").replace(/\..*/,"").replace(/\:/g,"-");return r}},Admin=React.createClass({displayName:"Admin",getInitialState:function(){return{hidden:!0,user:"",repo:"",branch:"",path:"gh-weblog",token:""}},componentDidMount:function(){var t=localStorage["gh-weblog-settings"];if(t)try{t=JSON.parse(t),t.hidden=this.props.hidden,this.setState(t)}catch(e){}},render:function(){return React.createElement("div",{className:"underlay",hidden:this.state.hidden,onClick:this.close},React.createElement("div",{className:"overlay",onClick:this.stopPropagation},React.createElement("button",{className:"logout",onClick:this.reset},"Log out"),React.createElement("h1",null,"Weblog administration settings"),React.createElement("table",null,React.createElement("tr",null,React.createElement("td",null,"Your github username:"),React.createElement("td",null,React.createElement("input",{type:"text",placeholder:"yourname",value:this.state.user,onChange:this.changeUser}))),React.createElement("tr",null,React.createElement("td",null,"github repository:"),React.createElement("td",null,React.createElement("input",{type:"text",placeholder:"yourname.github.io",value:this.state.repo,onChange:this.changeRepo}))),React.createElement("tr",null,React.createElement("td",null,"repository branch:"),React.createElement("td",null,React.createElement("input",{type:"text",placeholder:"master",value:this.state.branch,onChange:this.changeBranch}))),React.createElement("tr",null,React.createElement("td",null,"path to weblog:"),React.createElement("td",null,React.createElement("input",{type:"text",value:this.state.path,onChange:this.changePath})))),React.createElement("h1",null,"Github ",React.createElement("a",{href:"https://github.com/settings/applications"},"Personal Access Token")),React.createElement("input",{type:"text",className:"token",value:this.state.token,onChange:this.changeToken}),React.createElement("p",null,"Don't give this token more permissions than necessary! gh-weblog only needs repo access!")))},reset:function(){localStorage.removeItem("gh-weblog-settings"),this.setState({user:"",repo:"",branch:"",path:"gh-weblog",token:"",hidden:!0}),this.props.onLogout()},show:function(){this.setState({hidden:!1})},close:function(){this.setState({hidden:!0}),this.props.onClose({user:this.state.user,repo:this.state.repo,branch:this.state.branch,path:this.state.path,token:this.state.token})},stopPropagation:function(t){t.stopPropagation(),t.preventDefault()},changeUser:function(t){this.setState({user:t.target.value},this.update)},changeRepo:function(t){this.setState({repo:t.target.value},this.update)},changeBranch:function(t){this.setState({branch:t.target.value},this.update)},changePath:function(t){this.setState({path:t.target.value},this.update)},changeToken:function(t){this.setState({token:t.target.value},this.update)},update:function(){localStorage["gh-weblog-settings"]=JSON.stringify(this.state)}}),Editor=React.createClass({displayName:"Editor",getInitialState:function(){return{text:""}},componentDidMount:function(){this.setState({text:this.props.text})},render:function(){return React.createElement("textarea",{ref:"textarea",className:"editor",hidden:this.props.hidden,value:this.state.text,onChange:this.record})},setText:function(t){var e=this.refs.textarea.getDOMNode();this.setState({text:t},function(){e.focus()})},record:function(t){this.setState({text:t.target.value}),this.props.update(t)},finish:function(){this.props.view()}}),Entry=React.createClass({displayName:"Entry",mixins:[OnClickOutside],getInitialState:function(){return{id:-1,title:"",created:Date.now(),published:Date.now(),updated:Date.now(),tags:[],editing:!1,postdata:""}},componentDidMount:function(){var t=this.props.metadata;t.postdata=this.props.postdata,this.setState(t),this.registerOutsideClickListener(this.view)},render:function(){var t,e=this.getText(),n="gh-weblog-"+this.state.created,r="#"+n;this.props.editable&&(t=React.createElement("button",{className:"admin delete button",onClick:this.delete},"remove entry"));var s=new Date(this.state.published).toLocaleString(),i=new Date(this.state.updated).toLocaleString();return React.createElement("div",{className:"entry",id:n},t,React.createElement("header",null,React.createElement("h1",null,React.createElement("a",{href:r},this.state.title)),React.createElement("h2",null,"Originally posted on ",s,", last updated on ",i)),React.createElement(MarkDown,{ref:"markdown",hidden:this.state.editing,text:this.state.postdata,onClick:this.edit}),React.createElement(Editor,{ref:"editor",hidden:!this.state.editing,text:e,update:this.update,view:this.view,"delete":this.delete}),React.createElement("a",{className:"comments",href:this.props.issues},"leave a comment on github"),React.createElement(Tags,{disabled:!this.props.editable,tags:this.state.tags,onChange:this.updateTags}))},componentDidUpdate:function(){this.props.runProcessors(this.refs.markdown.getDOMNode())},updateTags:function(t){var e=this;this.setState({tags:t},function(){this.props.onSave(e)})},getText:function(){return"#"+this.state.title+"\n\n"+this.state.postdata},getMetaData:function(){var t=JSON.parse(JSON.stringify(this.state));return delete t.editing,delete t.postdata,t},getPostData:function(){return this.state.postdata},getHTMLData:function(){return this.refs.markdown.getHTML()},edit:function(){this.props.editable&&(this.refs.editor.setText(this.getText()),this.setState({editing:!0}))},update:function(t){var e=t.target.value.split("\n"),n=e.splice(0,1)[0].replace(/^#*/,""),r=e.join("\n").trim();this.setState({title:n,postdata:r,updated:Date.now()})},view:function(){this.state.editing&&(this.setState({editing:!1}),this.props.onSave(this))},"delete":function(){this.props.onDelete(this)},toRSS:function(){}}),MarkDown=React.createClass({displayName:"MarkDown",mixins:[MarkDownMixin],render:function(){return this.html=this.markdown(this.props.text),React.createElement("div",React.__spread({className:"post",hidden:this.props.hidden,onClick:this.props.onClick},this.html))},getHTML:function(){return this.html.dangerouslySetInnerHTML.__html}}),Tags=React.createClass({displayName:"Tags",render:function(){var t=this.props.tags.map(function(t,e){return React.createElement("div",{className:"tag",key:e},t)});return React.createElement("div",{className:"tags",onClick:this.updateTags},t)},updateTags:function(){if(!this.props.disabled){var t=this.props.tags.join(", "),e=prompt("Edit the post tags",t);t=e.split(",").map(function(t){return t.trim()}),this.props.onChange(t)}}}),WebLog=React.createClass({displayName:"WebLog",mixins:[ConnectorMixin,TimeToId,RSSGenerator],index:[],list:{},getInitialState:function(){return{singleton:!1,entries:this.list,slice:{start:0,end:10},githubissues:"",authenticated:!1,site:"",issues:""}},componentDidMount:function(){var t=localStorage["gh-weblog-settings"];t?(t=JSON.parse(t),this.connector=new this.Connector(t),t.token&&this.setState({authenticated:!0})):this.connector=new this.Connector;var e=window.location.hash||!1;e&&(e=e.indexOf("#gh-weblog")>-1?e.replace("#gh-weblog-",""):!1);var n=this.timeToId(e);n&&this.setState({singleton:!0}),this.connector.loadIndex(this.loadIndex,n);var r=document.createElement("a");r.href=this.props.base;var s=r.host.replace(".github.io",""),i=r.pathname.replace(/^\//,"").trim().split("/")[0],o=i?i:r.host;this.setState({site:"http://github.com/"+s+"/"+o,issues:"http://github.com/"+s+"/"+o+"/issues"})},render:function(){var t,e,n;return this.state.singleton||(n=React.createElement("button",{className:"authenticate",onClick:this.showSettings,onClose:this.bindSettings},"admin"),this.state.authenticated&&(t=React.createElement("button",{className:"admin post button",onClick:this.create},"new entry")),e=React.createElement("button",{onClick:this.more},"Load more posts")),React.createElement("div",{ref:"weblog",className:"gh-weblog"},React.createElement(Admin,{ref:"admin",hidden:"true",onClose:this.bindSettings,onLogout:this.onLogOut}),n,t,this.generateEntries(),e)},generateEntries:function(){var t=this;return this.getSlice().map(function(e){return React.createElement(Entry,{key:e.metadata.created,ref:e.metadata.id,issues:t.state.issues,metadata:e.metadata,postdata:e.postdata,editable:!t.state.singleton&&t.state.authenticated,runProcessors:t.runProcessors,onSave:t.save,onDelete:t.delete})})},runProcessors:function(t){this.props.processors&&this.props.processors instanceof Array&&this.props.processors.forEach(function(e){e(t)})},showSettings:function(){this.refs.admin.show()},bindSettings:function(t){this.connector.setProperties(t),t.token.trim()&&this.setState({authenticated:!0})},onLogOut:function(){this.setState({authenticated:!1})},more:function(){this.setState({slice:{start:this.state.slice.start,end:this.state.slice.end+10}},this.loadEntries)},getSlice:function(){var t=this.list,e=this.state.slice.start,n=this.state.slice.end,r=Object.keys(t).sort().reverse().slice(e,n);return r.map(function(e){return t[e]})},loadIndex:function(t,e){this.index=e.reverse(),this.loadEntries()},loadEntries:function(){var t=this.connector,e=this.setEntry,n=this.state.slice.start,r=this.state.slice.end,s=this.index.slice(n,r),i=this.list;!function o(n){if(0!==n.length){var r=n.splice(0,1)[0];return i[r]?o(n):void t.loadMetadata(r,function(s,i){return s?(console.error("no metadata found for id: "+r+" ("+s+")"),void o(n)):void t.loadEntry(r,function(t,s){return t?(console.error("no post data found for id: "+r+" ("+t+")"),void o(n)):(e(r,i,s),void o(n))})})}}(s)},setEntry:function(t,e,n){e.id=t,-1===this.index.indexOf(t)&&this.index.push(t),this.list[t]={metadata:e,postdata:n},this.setState({entries:this.list})},create:function(){var t=new Date,e=t.getTime(),n={title:"New Entry",created:e,published:e,updated:e,tags:[]},r="...click here to start editing your post...",s=this.timeToId(e);this.setEntry(s,n,r)},save:function(t){var e=this;this.setEntry(t.state.id,t.getMetaData(),t.postdata),this.connector.saveEntry(t,this.index,function(){console.log("save handled"),e.saveRSS()})},"delete":function(t){var e=confirm("really delete post?");if(e){var n=this,r=t.state.id,s=this.index.indexOf(r);this.index.splice(s,1),delete this.list[r],this.setState({entries:this.list}),this.connector.deleteEntry(t,this.index,function(){console.log("delete handled"),n.saveRSS()})}},saveRSS:function(){var t=this,e=this.connector;console.log("Updating RSS..."),e.saveRSS(t.toRSS(),function(){if(console.log("updated."),t.props.rssfeeds){console.log("Updating category-specific RSS...");var n=t.props.rssfeeds.split(",").map(function(t){return t.trim()}).filter(function(t){return!!t});!function r(){if(0===n.length)return console.log("All RSS feeds updated");var s=n.splice(0,1)[0];console.log("Updating category "+s),e.saveRSS(t.toRSS(s),s.toLowerCase(),r)}()}})}});