<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<atom:link href="http://pomax.github.io/gh-blog/gh-weblog/rss.xml" rel="self" type="application/rss+xml" />
<title>A Github Weblog</title>
<description>A simple github blog using markdown and octokit</description>
<link>http://pomax.github.io/gh-blog</link>
<lastBuildDate>Wed, 31 Dec 2014 19:29:22 GMT</lastBuildDate>
<pubDate>Wed, 31 Dec 2014 19:29:22 GMT</pubDate>
<ttl>1440</ttl>
<item>
<title>New Entry</title>
<description><p>...click here to start editing your post...</p>
</description>

<link>http://pomax.github.io/gh-blog/#gh-weblog-1420054160213</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1420054160213</guid>
<pubDate>Wed, 31 Dec 2014 19:29:20 GMT</pubDate>
</item>
<item>
<title>A client-side Mahjong scoring app, using React</title>
<description><p>2 weeks ago, on a Saturday, I thought I&#39;d revisit my old <a href="http://pomax.nihongoresources.com/downloads/mjscoring">PHP-based</a> <a href="http://en.wikipedia.org/wiki/Mahjong">mahjong</a> scoring application. We like playing Chinese Classical rules, which are a little more &quot;fun&quot; and a little less &quot;optimised for gambling&quot; that the usual rules, and one aspect of that is that it&#39;s much harder to track scores: everyone pays the winner, but the losers settle score differences amongst themselves in addition to paying the winner, too, and there&#39;s a fair number of different things to score. Plus, you can get both points and &quot;doubles&quot;, the latter of which doubles (surprise!) your total point score. Only 28 tile points but 5 doubles? That&#39;s 896 points total.</p>
<p>On that fateful Saturday, I decided I&#39;d put <a href="https://www.polymer-project.org">Polymer</a> to the test, and see if it&#39;d hold up. I was doing my dev work in <a href="http://www.sublimetext.com">Sublime Text 2</a> and <a href="http://www.google.com/chrome">Chrome</a>, and that combination worked just fine. And then after a day and a few hours on sunday, I tried it in <a href="http://firefox.com">Firefox</a>, and all my joy turned to hatred as the app broke all over the place. Polymer plain old didn&#39;t work (and at this point, sad to say, Polymer is dead to me). The bits that did we slow, the bits that didn&#39;t ultimately gave me too much of a headache trying to fix specifically for Firefox. I literally gave up: it was easy to port, too bad technology let me down.</p>
<p>However, as per the previous post, the Mozilla Foundation engineering team is considering using <a href="http://facebook.github.io/react">React</a>, and what better way to learn it than to take that broken Polymer app, and rewrite it as a React app? Long story short: a week later I ported the app from Polymer to React, and React works brilliantly in all browsers (yes, IE11 and Android 4.2 work) and is <em>fast</em> too boot. So... I have a new app up and running for scoring mahjong, and that makes me happy!</p>
<p><a href="http://pomax.github.io/mjscoring.js"><img src="gh-weblog/images/mjscoring-screenshot.jpg" class="border"></a></p>
<p>You can find it over on <a href="http://pomax.github.io/mjscoring.js">http://pomax.github.io/mjscoring.js</a>, with the source code living over on <a href="https://github.com/pomax/mjscoring.js">github</a> and I&#39;ve been using it along side some games played in <a href="https://www.4windsmj.com">Four Winds Mahjong</a> (which may look old, but is still the best at actually seriously playing MJ that I know of) to see if the scoring holds up, and after some initial bug fixing, it feels like it&#39;s doing just that. No more having to rely on a set of unmaintanable old PHP scripts anymore, and I even wrote it so that it&#39;ll be relatively easy to add in new scoring rules, for when you prefer to play HK rules. Which can be nice sometimes, if you don&#39;t want the cut-throat &quot;I need to destroy you, you&#39;re winning too much, but first I need to become east&quot; excitement that Chinese Classical rules bring to the table.</p>
<p>Game on.</p>
</description>
<category>React</category>
<category>Mahjong</category>
<link>http://pomax.github.io/gh-blog/#gh-weblog-1419403759737</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1419403759737</guid>
<pubDate>Wed, 24 Dec 2014 06:49:19 GMT</pubDate>
</item>
<item>
<title>So you're thinking about using React</title>
<description><p>I was in the same boat: at the Mozilla Foundation we&#39;re considering using React for the next few months as client-side framework of choice for new apps, and that means learning a new technology, because you can&#39;t make a decision on something you don&#39;t understand. So I took an app I was unhappy with due to framework choice, and rewrote the whole thing in React, taking notes on everything that felt weird, or didn&#39;t click.</p>
<p>I ended up writing about 6000 words worth of thoughts on React by the time I was done, and it took another 3000 or so to figure out what I had actually learned, and why React seemed so foreign at first, but so <em>right</em> once I got familiar with it. It&#39;s been great learning a new thing, and even better discovering that it&#39;s a thing I can love, but there&#39;s a reason for that, and I&#39;d like to distill my close to 10k words into something that you can read, so that you might understand where React&#39;s coming from.</p>
<p>So: if you&#39;re used to other frameworks (whether they&#39;re MVC, MVVM, some other paradigm or even just plain JS and HTML templating engines), and you feel like React is doing something very weird, don&#39;t worry: if you treat it as HTML+JS, React is really, really weird. However, the reason for it is actually you: React is not about doing things as HTML+JS, it&#39;s about writing applications using plain old object oriented programing... The objects just happen to be able to render themselves as UI elements, and the UI happens to be the browser. The logic behind what you&#39;re programming, as such, depends on knowing that you&#39;re doing OOP, and making sure you&#39;re thinking about modelling your elements and interactions based on object interactions as you would in any other OOP design setting.</p>
<p>The bottom line: React has <em>almost</em> nothing to do with HTML. And for a web framework, <strong>that&#39;s</strong> weird. Although only a little, as we&#39;ll see in the rest of this post.</p>
<p>The best way I can think of to get to business is with a table that compares the various aspects of programming to how you express those things when you&#39;re using HTML, versus how you express those things when you&#39;re using React&#39;s object model. I&#39;m calling it JSX because that&#39;s what React calls it, but really it&#39;s &quot;React&#39;s object model&quot;.</p>
<p>So, here goes:</p>
<table>
<thead>
<tr>
<th style="text-align:left">concepts</th>
<th style="text-align:center">HTML</th>
<th style="text-align:center">JSX</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">&quot;thing&quot; to think in terms of</td>
<td style="text-align:center">DOM elements</td>
<td style="text-align:center">components (React XML elements)</td>
</tr>
<tr>
<td style="text-align:left">Is this MVC?</td>
<td style="text-align:center">there is no explicit model</td>
<td style="text-align:center">components wrap MVC</td>
</tr>
<tr>
<td style="text-align:left">internal structure</td>
<td style="text-align:center">DOM tree</td>
<td style="text-align:center">components tree</td>
</tr>
<tr>
<td style="text-align:left">scope</td>
<td style="text-align:center">global (<code>window</code>)</td>
<td style="text-align:center">local component and <code>this.refs</code> only</td>
</tr>
<tr>
<td style="text-align:left">contextual id</td>
<td style="text-align:center"><code>id</code> attribute</td>
<td style="text-align:center"><code>ref</code> attribute</td>
</tr>
<tr>
<td style="text-align:left">hashcode</td>
<td style="text-align:center">n/a</td>
<td style="text-align:center"><code>key</code> attribute</td>
</tr>
<tr>
<td style="text-align:left">mutable properties</td>
<td style="text-align:center">HTML attributes</td>
<td style="text-align:center">internal object properties</td>
</tr>
<tr>
<td style="text-align:left">bootstrap properties</td>
<td style="text-align:center">n/a</td>
<td style="text-align:center">component <code>props</code></td>
</tr>
<tr>
<td style="text-align:left">property types</td>
<td style="text-align:center">strings</td>
<td style="text-align:center">any legal JS construct</td>
</tr>
<tr>
<td style="text-align:left">internal state</td>
<td style="text-align:center">...</td>
<td style="text-align:center">component <code>state</code></td>
</tr>
<tr>
<td style="text-align:left">style assignment</td>
<td style="text-align:center"><code>class</code> attribute</td>
<td style="text-align:center"><code>className</code> attribute</td>
</tr>
<tr>
<td style="text-align:left">hierarchy accessors</td>
<td style="text-align:center">DOM child/parent access</td>
<td style="text-align:center">local access only</td>
</tr>
<tr>
<td style="text-align:left">content comes from...</td>
<td style="text-align:center">any mix of DOM + JS</td>
<td style="text-align:center">purely the component state</td>
</tr>
<tr>
<td style="text-align:left">content manipulation</td>
<td style="text-align:center">DOM API</td>
<td style="text-align:center">setState</td>
</tr>
</tbody>
</table>
<p>I&#39;m going to be running through each of these points in order (mostly), and I&#39;d strongly advise you not to skip to just the step &quot;you care about&quot;. Unless you gave up on the notion that you&#39;re writing a webpage rather than an object oriented application that happens to render its UI elements as inaccessible HTML, you&#39;re going to want to read all of them. In fact, humour me: even if you have, read every point anyway. They build on each other.</p>
<h2 id="the-thing-that-you-re-working-on">The &quot;thing&quot; that you&#39;re working on</h2>
<p>In a traditional web setting, you have the data, the markup around that data, the styling of that markup, and the interaction logic that lets you bridge the gap between the data and the user. These things are typically your data, your HTML, your CSS and your JavaScript, respectively.</p>
<p>That is not how you model in React. React is far more like a traditional programming language, with objects that represent your functional blocks. Each object has an initial construction configuration, a running state, and because we&#39;re working on the web, each object has a <code>.render()</code> function that will produce a snapshot of the object, serialized into HTML that is &quot;done&quot; as far as React is concerned. Nothing you can do to it will be meaningful for the object that generated it. React could, essentially, be anything. If it rendered to native UI or to GTK or Java Swing, you&#39;d never know, since React&#39;s written in a way that everything your components might conceivably want to do is contained in your object&#39;s code.</p>
<p>It&#39;s also much more like a traditional OOP environment in that objects don&#39;t &quot;take things from other objects&quot;. Where in HTML+JS you might do a <code>document.querySelector(&quot;#maincontainer div.secondary ol li.current&quot;)</code> and then manipulate what comes rolling out of that, in React, you delegate. There is no &quot;global&quot; context to speak of, so you&#39;d have a Main component, containing a Secondary component, and that&#39;s all Main can see. If it wants to initiate things on &quot;the current selected list item&quot;, it tells the contained Secondary element to take care of it, without caring <em>how</em> it takes care of it. The code for doing things lives inside the things that do the doing.</p>
<p>This is pitfall number one if you&#39;re starting with React: <strong>you&#39;re not writing HTML, you&#39;re doing object oriented programming with a to-HTML-render pipeline step at the end</strong>.</p>
<h2 id="is-this-mvc-">Is this MVC?</h2>
<p>If you think in terms of Model/View/Controller separation (and let&#39;s be clear here: that&#39;s just one of many possible ways to model data visualisation and interaction), you might be wondering if React is an MVC framework, to which the only real answer is &quot;that question has assumptions that don&#39;t really apply here&quot; (which is why comparing React to Ember or Angular or the like doesn&#39;t really make all that much sense). React is an object oriented modeling framework, whereas MVC frameworks are MVC frameworks.</p>
<p>If we absolutely have to express React in terms of MVC: each component is responsible for housing all MVC aspects, in isolation of every other component:</p>
<ul>
<li>the model aspect is captured as the component properties (its config) and state (it&#39;s current data),</li>
<li>the view aspect is captured as the <code>render</code> function, generating new views every time either the configuration or state updates, and</li>
<li>the control aspect is covered by all the functions defined on the object that you (or React) intend to be called either through interaction with the component, or as public API, to be called by other components.</li>
</ul>
<h2 id="the-internal-structure-of-things-">The internal structure of &quot;things&quot;</h2>
<p>In HTML+JS, the structure of your functional blocks are just &quot;more HTML&quot;. In React, you&#39;re using a completely different thing. It&#39;s a <em>little</em> bit different in terms of what it looks like (you should be entirely forgiven for thinking you&#39;re working with HTML except using XML syntax) but it&#39;s completely different in what it <em>is</em>: React uses a syntax that lets you define what look like XML structures, which are transformed into key/value maps. It&#39;s these key/value maps that React uses internally as the canonical representation of your object. That&#39;s a lot of words for the summary &quot;it&#39;s not HTML, just a sort of familiar syntax to make development easy&quot;.</p>
<p>Let&#39;s unpack that a little more: the JSX syntax uses tags that <em>map</em> to HTML elements during the final render pipeline step. They are, however, most emphatically <strong>not</strong> real HTML elements, and certainly not elements that end up being used in the browser. The reason here is that React uses an internal snapshot representation that lets it perform diffs between successive render calls. Each call generates a snapshot, a new snapshot is structurally compared to the previous one, and differences between them are translated into transforms that the browser can selectively apply to the snapshot&#39;s associated active DOM. It&#39;s super fast, but also means that the JSX you write has almost nothing to do with what the browser will end up using as DOM.</p>
<p>This is pitfall number two, and really is just a rephrasing of pitfall number one: <strong>React objects aren&#39;t &quot;backed by HTML&quot;, nor is the browser DOM &quot;backed by a React object&quot;. What the browser shows you is just snapshots of React objects throughout their life cycle.</strong></p>
<h2 id="html-is-unscoped-react-objects-are-scoped-as-per-oop-rules-">HTML is unscoped, React objects are scoped as per OOP rules.</h2>
<p>Since we have no DOM, and we&#39;re doing proper OOP, React components know about their own state, and only their own state. To get around being completely isolated the normal OOP approaches apply for making components aware of things outside of their scope: they can be passed outside references during creation (i.e. these are constructor arguments; the constructor syntax just happens to look like, but conceptually is not, markup), or they can be passed in later by calling functions on the object that let you pass data in, and get data back as function return or via callbacks.</p>
<p>Which brings us to pitfall number three: <strong>If you&#39;re using <code>window</code> or some other dsignated master global context in React objects, you&#39;re probably doing something wrong.</strong></p>
<p>Everything you do in React you can achieve without the need for a global context. A component should only need to care about the things it was given when it was born, and the immediately visible content it has as described in its <code>render()</code> function. Which brings us to the next section</p>
<h2 id="how-do-we-find-the-right-nodes-">How do we find the right nodes?</h2>
<p>In HTML the answer is simple: <code>querySelect(&quot;#all.the[things]&quot;)</code>. In React the answer is equally simple, as long as we obey OOP rules: We don&#39;t know anything about &quot;higher up&quot; elements and we only know about our immediate children. That last bit is important: we should not care about our children&#39;s children in the slightest. Children are black boxes and if we need something done to our children&#39;s children, we <em>needSomethingDone()</em>, so we call our children&#39;s API functions and trust that they do the right thing, without caring in the slightest <em>how</em> they get them done.</p>
<p>That&#39;s not to say you might not want to &quot;highlight the input text field when the main dialog gains focus&quot; but that&#39;s the HTML way of thinking. In React, when the dialog gains focus you want to tell all children that focus was gained, and then they can do whatever that means to them. If one of those children houses the input, then it should know to update its state to one where the input renders as highlighted. React&#39;s diffing updates will then take care of making sure it&#39;s still the same DOM element that gets highlight despite the <code>render()</code> call outputting a <em>new</em> snapshot.</p>
<p>So, how do we get our own children? In HTML we can use the globally unique <code>id</code> attribute, and the same concept but then scoped locally to React objects is the <code>ref</code> attribute: <code>&lt;div ref=&quot;abcd&quot;&gt;...&lt;/div&gt;</code> will let us manipulate the <strong>React XML element</strong> that represents as <code>this.refs.abcd</code> in our code. Again: there is no HTML. Similarly, we can select any other React XML element to work with through <code>this.refs</code> so if we have a React element <code>&lt;ModalDialog ref=&quot;md&quot; /&gt;</code> then we can grab it from <code>this.refs.md</code> and call its functions so that it does what we need, such as <code>this.refs.md.setTitle(&quot;Enhanced modal titles are a go&quot;);</code>.</p>
<h2 id="the-secret-sauce-in-react-s-diffing-elements-have-hashcodes-and-sometimes-that-s-on-you-">The secret sauce in React&#39;s diffing: elements have hashcodes, and sometimes that&#39;s on you.</h2>
<p>Because React generates new XML tree snapshots every time <code>render()</code> gets called, it needs a way to order elements reliably, for which it uses hashcodes. These are unique identifiers <em>local to the component they&#39;re used in</em> that let React check two successive snapshots for elements with the same code, so that it can determine whether they moved around, whether any attributes changed, etc. etc.</p>
<p>For statically defined JSX, React can add these keys automatically, but it can&#39;t do that for dynamic content. When you&#39;re creating renderable content dynamically (and the only place you&#39;ll do this is in <code>render()</code>; if you do it anywhere else, you&#39;re doing React wrong) you need to make sure you add <code>key</code> attributes to your JSX. And example:</p>
<pre><code>render: function() {
  var list = this.state.mylist.map(function(obj) {
    return &lt;li key={obj.internalid}&gt;{obj.text}&lt;/li&gt;
  });
  return &lt;ol&gt;{list}&lt;/ol&gt;;
}
</code></pre><p>If we don&#39;t add <code>key</code> attributes in this JSX, React will see successive snapshots with unmarked elements, and will simply key them them based on their position. This is fairly inefficient, and can lead to situations where lists are generated without a fixed order, making React think multiple elements changed when in fact elements merely moved around. To prevent this needlessly expensive kind up updating, we explicitly add the <code>key</code> attribute for each <code>obj</code> in our list <code>mylist</code> so that they&#39;re transformed into XML elements that will eventually end up being rendered as an HTML list item in the browser, while letting React see actual differences in successive snapshots.</p>
<p>If, for instance, we remove the first element in <code>mylist</code> because we no longer need it, none of the other elements change, but without key attributes React will see every element as having changed, because the position for each element has changed. With key attributes, it&#39;ll see that the elements merely moved and one of them disappeared.</p>
<p>The simplest <code>key</code> when generating content, if you know your list stays ordered, is to make it explicit that you really do just want the position that React makes use of when you forget to add keys:</p>
<pre><code>render: function() {
  var list = this.state.mylist.map(function(obj, idx) {
    return &lt;li key={idx}&gt;{obj.text}&lt;/li&gt;
  });
  return &lt;ol&gt;{list}&lt;/ol&gt;;
}
</code></pre><p>However, while this will make React &quot;stop complaining&quot; about missing keys, this will also almost always be the &quot;wrong&quot; way to do keys, due to what React will see once you modify the list, rather than only ever appending to it. Generally, if you have dynamic content, spend a little time thinking about what can uniquely identify elements in it. Even if there&#39;s nothing you can think of, you can always use an id generator dedicated to just those elements:</p>
<pre><code>render: function() {
  var list = this.state.mylist.map(function(obj) {
    return &lt;li key={obj.key}&gt;{obj.text}&lt;/li&gt;
  });
  return &lt;ol&gt;{list}&lt;/ol&gt;;
},
generateKey: (function() {
  var id = 1;
  return function() { return id++; };
},
addEntry: function(obj) {
  obj.key = generateKey();
  this.setState({
    mylist: this.state.mylist.concat([obj])
  });
}
</code></pre><p>Now, every time we add something that needs to go in our list, we make sure that they have a properly unique key even before the object makes it into the list. If we now modify the list in any way, the objects retain their keys and React will be able to use its optimized diffing and stay nice and fast.</p>
<p>Before we move on, <strong>a warning</strong>: keys uniquely identify React XML elements, which also means that if you use <code>key</code> attributes, but some elements share the same value, React will treat these &quot;clearly different&quot; elements as &quot;the same element&quot;, and the last element in a list of same-key elements will make it into the final browser DOM. The reason here is that keys are literally JavaScript object keys,  and are used by React  to build an internal element object of the standard JavaScript kind, forming</p>
<pre><code>{
  key1: element,
  key2: element,
  ...
}
</code></pre><p>React runs through the elements one by one and adds key:element bindings to this object, so when it sees a second (or third, or fourth, etc) element with <code>key1</code> as key value, then the result of React&#39;s <code>obj[key]=element</code> is that the previously bound element simply gets clobbered.</p>
<p>This, for instance, is a list with only a single item, no matter how many items are actually in <code>mylist</code>:</p>
<pre><code>render: function() {
  var key = 1;
  var list = this.state.mylist.map(function(obj) {
    return &lt;li key={key}&gt;{obj.text}&lt;/li&gt;
  });
  return &lt;ol&gt;{list}&lt;/ol&gt;;
}
</code></pre><h2 id="mutable-properties">Mutable properties</h2>
<p>We can be brief here: in HTML, all element attributes are mutable properties. In React, the only true mutable properties you have are the normal JavaScript object property kind of properties.</p>
<h2 id="immutable-properties">Immutable properties</h2>
<p>This one&#39;s stranger, if you&#39;re used to HTML, because there aren&#39;t really any immutable properties when it comes to HTML elements.</p>
<p>In React, however, there are two kinds of immutable properties: the construction properties and the object&#39;s internal state. The first is used to &quot;bootstrap&quot; a component, and you can think of it as the constructor arguments you pass into a creation call, or the config or options object that you pass along during construction. These values are &quot;set once, never touch&quot;. Your component uses them to set its initial state, and then after that the properties are kind of done. Except to reference the initial state (like during a reset call), they don&#39;t get used again. Instead, you constantly update the object&#39;s &quot;state&quot;. This is the collection that defines everything that makes your object uniquely that object in time. An example</p>
<pre><code>ParentElement = {
  ...
  render: function() {
    var spectype = 3;
    return &lt;ChildElement name=&quot;antonius&quot; type={spectype} onClick={this.someHandler}/&gt;
  },
  ...
}
</code></pre><p>and</p>
<pre><code>ChildElement = {
  ...
  getInitialState: function() {
    return {
      name: &#39;&#39;,
      type: -1
    };
  },
  componentDidMount: function() {
    this.setState({
      name: this.props.name,
      type: this.props.type
    });
  },
  render: function() {
    return (
      &lt;div&gt;
        &lt;span&gt;{this.state.name}&lt;/span&gt;
        (&lt;span&gt;{this.state.type}&lt;/span&gt;)
      &lt;/div&gt;
    );
  },
  ...
}
</code></pre><p>We see the child element, with an intial &quot;I have no idea what&#39;s going on&quot; state defined in the <code>getInitialState</code> function. Once the element&#39;s been properly created and is ready to be rendered (at which point <code>componentDidMount</code> is called) it copies its creation properties into its state, setting up its &quot;true&quot; form, and after that the role of <code>this.props</code> is mostly over. Rendering relies on tapping into <code>this.state</code> to get the to-actually-show values, and we can modify the element&#39;s state through its lifecycle by using the <code>setState()</code> function:</p>
<pre><code>ChildElement = {
  ...
  render: function() {
    return &lt;div onClick={this.rename}&gt;{this.state.name}&lt;/div&gt;;
  },
  rename: function(event) {
    var newname = prompt(&quot;Please enter a new name&quot;);
    this.setState({ name: newname });
  },
  ...
}
</code></pre><p>The chain of events here is: <code>render()</code> -&gt; the user clicks on the name -&gt; <code>rename()</code> is called, which prompts for a new name -&gt; the element&#39;s state is updated so that <code>name</code> is this new name -&gt; <code>render()</code> is called because the element&#39;s state was updated -&gt; React compared the new render output to the old output and sees a string diff in the <code>&lt;div&gt;</code> XML element -&gt; React causes the browser to update the mapped HTML element so we see the new name.</p>
<h2 id="what-can-i-pass-as-property-values-">What can I pass as property values?</h2>
<p>In HTML the answer is &quot;strings&quot; - it doesn&#39;t matter what you pass in, if you use it as HTML attribute content, it becomes a string.</p>
<p>In React, the answer is &quot;everything&quot;. If you pass in a number, it stays a number. If you pass in a string, it stays a string. But, more importantly, if you pass in an object or function reference, <strong>it stays an object or function reference</strong> and that&#39;s how owning elements can set up meaningful deep bindings with child or even descendant elements.</p>
<h2 id="if-there-is-no-html-how-do-i-style-my-stuff-">If there is no HTML, how do I style my stuff??</h2>
<p>React elements can use the <code>className</code> property so that you can use regular CSS styling on them. Anything passed into the <code>className</code> property gets transformed to the HTML <code>class</code> attribute at the final step of rendering.</p>
<h2 id="what-if-i-need-id-s-">What if I need <code>id</code>s?</h2>
<p>You don&#39;t. Even if you have a single element that will always be the only single instance of that React object, ever, you could still be wrong. <code>id</code> attributes cannot be guaranteed in an environment where every component only knows about itself, and its immediate children. There is no global scope, so setting a global scope identifier makes absolutely no sense.</p>
<h2 id="but-what-if-i-need-to-tie-functionality-to-what-i-need-an-id-on-element-">But what if I need to tie functionality to what-I-need-an-id-on element?</h2>
<p>Add it:</p>
<pre><code>Element = {
  ...
  render: function() {
    return &lt;div className=&quot;top-level-element&quot;&gt;........&lt;/div&gt;;
  },
  ...
}
</code></pre><p>surprise: you can querySelect your way to this element just fine with a <code>.top-level-element</code> query selector.</p>
<h2 id="but-that-s-slower-than-ids-">But that&#39;s slower than ids!</h2>
<p>Not in modern browsers, no. Let&#39;s move on.</p>
<h2 id="how-do-i-access-elements-hierarchically-">How do I access elements hierarchically?</h2>
<p>As should be obvious by now, we don&#39;t have querySelector available, but we do have a full OOP environment at our fingertips, so the answer is <strong>delegate</strong>. If you need something done to a descendant, tell your child between you and that descendant to &quot;make it happen&quot; and rely on their API function to do the right thing. How things are done are controlled by the things that do the actual doing, but that doesn&#39;t mean they can&#39;t offer an API that can be reached: <code>X:Y.doIt()</code> -&gt; <code>Y.doIt() { this.refs.Z.doIt(); }</code> -&gt; <code>Z.doIt() { this.refs.actualthing.doIt(); }</code></p>
<p>Similarly, if you need parents to do things, then you need to make sure those parents construct the element with a knowledge of what to call:</p>
<pre><code>ParentElement = {
  ...
  render: function() {
    return &lt;ChildElement doit={this.doit}/&gt;
  },
  doit: function() {
    ...
  },
  ...
}
</code></pre><p>and</p>
<pre><code>ChildElement = {
  ...
  render: function() {
    return &lt;div onClick={this.props.doit}&gt;do it&lt;/div&gt;;
  },
  ...
}
</code></pre><h1 id="what-else-is-there-">What else is there?</h1>
<p>This kind of covers everything in a way that hopefully makes you realise that React is a proper object oriented programming approach to page and app modelling, and that it has almost nothing to do with HTML. Its ultimate goal of course is to generate HTML that the browser knows how to show and work with, but that view and React&#39;s operations are extremely loosely coupled, and mostly works as a destructive rendering of the object: the DOM that you see rendered in the browser and the React objects that lead to that DOM are not tied together except with extremely opaque React hooks that you have no business with.</p>
<p>More posts will follow because this is hardly an exhausted topic, but in the mean time: treating React as a proper OOP environment actually makes it a delight to work with. Treating it as an HTML framework is going to leave you fighting it for control nonstop.</p>
<p>So remember:</p>
<ol>
<li><strong>you’re not writing HTML, you’re doing object oriented programming with a to-HTML-render pipeline step at the end.</strong></li>
<li><strong>React objects aren’t “backed by HTML”, nor is the browser DOM “backed by a React object”. What the browser shows you is just snapshots of React objects throughout their life cycle.</strong></li>
<li><strong>Your objects have creation properties, but you should always render off of the &quot;current state&quot;. If you need to copy those properties into your state right after creation, do. Then forget they&#39;re even there.</strong></li>
</ol>
<p>The best way I can think of to get to business is with a table that compares the various aspects of programming to how you express those things when you&#39;re using HTML, versus how you express those things when you&#39;re using React&#39;s object model. I&#39;m calling it JSX because that&#39;s what React refers to it, but really it&#39;s &quot;React&#39;s object model&quot;.</p>
</description>
<category>Mozilla</category>
<category>React</category>
<category>HTML</category>
<category>OOP</category>
<link>http://pomax.github.io/gh-blog/#gh-weblog-1419289380022</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1419289380022</guid>
<pubDate>Mon, 22 Dec 2014 23:03:00 GMT</pubDate>
</item>
<item>
<title>Let's make a Firefox Extension, the painless way</title>
<description><p>Ever had a thing you really wanted to customise about <a href="http://firefox.com">Firefox</a>, but you couldn&#39;t because it wasn&#39;t in any regular menu, advanced menu, or <a href="http://kb.mozillazine.org/Firefox_:_FAQs_:_About:config_Entries">about:config</a>?</p>
<p>For instance, you want to be able to delete elements on a page for peace of mind from the context menu. How the heck do you do that? Well, with the publication of the new node-based <a href="https://www.npmjs.com/package/jpm">jpm</a>, the answer to that question is &quot;pretty dang simply&quot;...</p>
<p>Let&#39;s make our own Firefox extension with a &quot;Delete element&quot; option added to the context menu:</p>
<p><img src="http://i.imgur.com/duBHYhj.png" alt="a screenshot of the Firefox page context menu with a &#39;delete element&#39; option"></p>
<p>We&#39;re going to make that happen in five steps.</p>
<ol>
<li>Install jpm -- in your terminal simply run: <code>npm install -g jpm</code> (make sure you have <a href="http://nodejs.org">node.js</a> installed) and done (this is mostly prerequisite to developing an extension, so you only have to do this once, and then never again. For future extensions, you start at step 2!)</li>
<li>Create a dir for working on your extension whereveryou like, navigate to it in the terminal and run: <code>jpm init</code> to set up the standard files necessary to build your extension. Good news: it&#39;s very few files!</li>
<li>Edit the <code>index.js</code> file that command generated, writing whatever code you need to do what you want to get done,</li>
<li>Turn your code into an <code>.xpi</code> extension by running : <code>jpm xpi</code>,</li>
<li>Install the extension by opening the generated <code>.xpi</code> file with Firefox</li>
</ol>
<p>Of course, step (3) is the part that requires some effort, but let&#39;s run through this together. We&#39;re going to pretty much copy/paste the code straight from the <a href="https://developer.mozilla.org/en-US/Add-ons/SDK/Tutorials/Add_a_Context_Menu_Item">context menu API</a> documentation:</p>
<pre><code>    // we need to make sure we have a hook into &quot;things&quot; we click on:
1:  var self = require(&quot;sdk/self&quot;);

    // and we&#39;ll be using the context menu, so let&#39;s make sure we can:
2:  var contextMenu = require(&quot;sdk/context-menu&quot;);

    // let&#39;s add a menu item!
3:  var menuItem = contextMenu.Item({
      // the label is pretty obvious...
4:    label: &quot;Delete Element&quot;,

      // the context tells Firefox which things should have this in their context
      // menu, as there are quite a few elements that get &quot;their own&quot; menu,
      // like &quot;the page&quot; vs &quot;an image&quot; vs &quot;a link&quot;. .. We pretty much want
      // everything on a page, so we make that happen:
5:    context: contextMenu.PredicateContext(function(data) { return true; }),

      // and finally the script that runs when we select the option. Delete!
6:    contentScript: &#39;self.on(&quot;click&quot;, function (node, data) { node.outerHTML = &quot;&quot;; });&#39;
    });
</code></pre><p>The only changes here are that we want &quot;delete&quot; for everything, so the context is simply &quot;for anything that the context menu opens up on, consider that a valid context for our custom script&quot; (which we do by using the <a href="https://developer.mozilla.org/en-US/Add-ons/SDK/High-Level_APIs/context-menu#PredicateContext%28predicateFunction%29">widest context possible</a> on line 5), and of course the script itself is different because we want to delete nodes (line 6).</p>
<p>The <a href="https://developer.mozilla.org/en-US/Add-ons/SDK/High-Level_APIs/context-menu#In_content_scripts">contentScript</a> property is a string, so we&#39;re a little restricted in what we can do without all manner of fancy postMessages, but thankfully we don&#39;t need it: the addon mechanism will always call the contentScript function with two arguments, &quot;node&quot; and &quot;data, and the &quot;node&quot; argument is simply the HTML element you clicked on, which is what we want to delete. So we do! We don&#39;t even try to be clever here, we simply set the element&#39;s <a href="https://developer.mozilla.org/en-US/docs/Web/API/element.outerHTML">.outerHTML</a> property to an empty string, and that makes it vanish from the page.</p>
<p>If you expected more work, then good news: there isn&#39;t any, we&#39;re already done! Seriously: run <code>jpm run</code> yourself to test your extension, and after verifying that it indeed gives you the new &quot;Delete element&quot; option in the context menu and deletes nodes when used, move on to steps (4) and (5) for the ultimate control of your browser.</p>
<p>Because here&#39;s the most important part: the freedom to control your online experience, and Firefox, go hand in hand.</p>
</description>
<category>Mozilla</category>
<category>Firefox</category>
<category>JPM</category>
<category>Extensions</category>
<category>Addons</category>
<link>http://pomax.github.io/gh-blog/#gh-weblog-1418833974687</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1418833974687</guid>
<pubDate>Wed, 17 Dec 2014 16:32:54 GMT</pubDate>
</item>
<item>
<title>I Blame Mike H.</title>
<description><p>Sometimes you see <a href="https://twitter.com/mikeaich/status/544976045313503232">a tweet</a> that points to <a href="http://wtfjs.com/2013/02/12/obfuscated-fibonacci">a post</a> and you leave what is the comment equivalent of a wink, but then things spiral out of control...</p>
<p>What does an obfuscated <a href="http://en.wikipedia.org/wiki/Lucas_number">Lucas series</a> generator look like? (Note: not <a href="http://en.wikipedia.org/wiki/Lucas_sequence">Lucas sequence</a>, because that&#39;s a very different thing).</p>
<p>To answer this, a quick bit of nifty: you know the Fibonacci series. Even if you don&#39;t, it takes almost no time to explain: it starts as 1, 1 and then the next term is the sum of the previous two, so it goes 1, 1, then 2 (1+1), then 3 (2+1), then 5 (3+2), 8 (5+3), and so forth. The Lucas series starts with 2,1 instead, so we get 2, 1, 3, 4, 7, 11, 18, 29, and so forth.</p>
<p>Now, any series like this (doesn&#39;t matter which 2 numbers you start with) ends up with a &quot;<a href="http://en.wikipedia.org/wiki/Golden_ratio">golden ratio</a>&quot; between any number <code>n</code> and the previous number <code>n-1</code>, in that <code>f(n)/f(n-1)</code> tends to the golden ratio value, the higher <code>n</code> gets. For the Fibonacci series, the fun ends there.</p>
<p>BUT!</p>
<p>The Lucas series is really cool. Let&#39;s call the golden ratio φ, and the number in the Lucas series simply &quot;lucas(...). Then : lucas(1) = 2, lucas(2) = 1, lucas(3) = 3, lucas(4) = 4, lucas(5) = 7, lucas(6) = 11, etc. But now check this out: φ<sup>1</sup> ≈ 1.618, φ<sup>2</sup> ≈ 2.618,  φ<sup>3</sup> ≈ 4.236, φ<sup>4</sup> ≈ 6.854, φ<sup>5</sup> ≈ 11.090,  φ<sup>6</sup> ≈ 17.944, φ<sup>7</sup> ≈ 29.034, etc.</p>
<p>Notice anything? What if we round those ratio powers?</p>
<p>φ<sup>1</sup> ≈ 2, φ<sup>2</sup> ≈ 3,  φ<sup>3</sup> ≈ 4, φ<sup>4</sup> ≈ 7, φ<sup>5</sup> ≈ 11, φ<sup>6</sup> ≈ 18, φ<sup>7</sup> ≈ 29, etc.</p>
<p>We see that lucas(n) is equivalent to φ<sup>n-1</sup>, if we round the latter. This isn&#39;t just for the first few terms, either, this holds true for <em>every</em> lucas number. That&#39;s amazing! It&#39;s so amazing that there&#39;s a <a href="https://www.youtube.com/watch?v=PeUbRXnbmms">numberphile youtube video about it</a>.</p>
<p>Okay, so let&#39;s figure out the obfuscation. In Javascript <code>+[]</code> is the number 0, because JS will see a <code>+</code> and try to interpret what follows as a number. Normally <code>[]</code> is an empty array, but due to some very interesting rules, an empty array can be coerced to the number zero if absolutely necessary, so JS will do this for us. We can get the number 1 in a variety of ways, but the one used in Mike&#39;s tweet is <code>++[+[]][+[]]</code>, which is equivalent to <code>++[0][0]</code>. You might understand this immediately if I said <code>var array = [0]; ++array[0];</code>, because that&#39;s obviously going to give 1. Clever.</p>
<p>Now then, let&#39;s get cracking! First off, let&#39;s generate the golden ratio in minimal JS. One of the interesting things about the golden ratio is that you can write it as an infinitely <a href="http://en.wikipedia.org/wiki/Continued_fraction">continued fraction</a> involving only the number 1: it&#39;s 1, plus 1/... where the ... is 1 + 1/..., in which <em>that</em> ... is 1 + 1/... in which <strong>that</strong> ... is 1 + 1/... in whi-- well you get the idea.</p>
<p>If we do that in reverse, we can build the golden ratio by starting with some <code>r = 1</code> and then running <code>r = 1 + 1/r</code> a large number of times. This&#39;ll generate the series 1, 2, 1.5, 1.666..., 1.6, 1.625, 1.615384, ..., 1.6180371352785146, ..., 1.6180339631667064, and if we run it long enough, something starting with 1.618033988749895, in which those 16 significant digits don&#39;t change. That&#39;s good enough for me.</p>
<p>In fact, I&#39;ll settle for 1.618033988749989, which is what you get if we run that <code>r = 1 + 1/r</code> 32 times.</p>
<p>Let&#39;s Javascriptify:</p>
<pre><code>for(r = 1, s = 32; s&gt;0; r = 1 + 1/r, s--); r
</code></pre><p>Good start. Rewriting time:</p>
<pre><code>for(r = ++[+[]][+[]], s = 32; s&gt;+[]; r = ++[+[]][+[]] + (++[+[]][+[]]/r), s--); r
</code></pre><p>Now for that s... I picked 32 for a reason, because if we use some bit shifting, it&#39;s 1 &lt;&lt; 6, or 2 &lt;&lt; 2 &lt;&lt; 2, and 2 is pretty easy to get when we already have <code>r = 1</code>:</p>
<pre><code>r = ++[+[]][+[]];
s = ++[r][+[]]&lt;&lt;++[r][+[]]&lt;&lt;++[r][+[]]
</code></pre><p>Splendid, we now have <code>r=1</code> and <code>s=32</code>:</p>
<pre><code>for(r = ++[+[]][+[]], s = ++[r][+[]]&lt;&lt;++[r][+[]]&lt;&lt;++[r][+[]]; s&gt;+[]; r = ++[+[]][+[]] + (++[+[]][+[]]/r),
 s--); r
</code></pre><p>Still too readable though, let&#39;s replace <code>r</code> with <code>_</code> and <code>s</code> with <code>__</code>:</p>
<pre><code>for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]];__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_),__--);_
</code></pre><p>Nice. In fact, let&#39;s increase our accuracy just a little bit more with one more shift:</p>
<pre><code>for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_), __--);_
</code></pre><p>And now we get 1.618033988749895 when we run this. Golden ratio found!</p>
<p>Now for the Lucas numbers:</p>
<pre><code>function lucas(n) {
  for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_), __--);
  return Math.round(Math.pow(_, n-1));
}
</code></pre><p>But of course that&#39;s again way too readable. Let&#39;s drop those Math.functions:</p>
<pre><code>function lucas(n) {
  for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_), __--);
  return (0.5 + Math.pow(_, n-1)) | 0;
}
</code></pre><p>A little better: Javascript can be tricked into floor-rounding by using any bit operation, so <code>6.34 | 0</code> becomes 6, as does <code>6.34 &lt;&lt; 0</code> (shift by 0 bits) or <code>6.34 &gt;&gt; 0</code> (also shift, opposite direction). If instead of floor rounding we want normal rounding, we have to add 0.5 first. But we only have integers in our obfuscated code, so we use 1 divided by 2:</p>
<pre><code>function lucas(n) {
  for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_), __--);
  return (1/2 + Math.pow(_, n-1)) | 0;
}
</code></pre><p>Let&#39;s get obfuscating</p>
<pre><code>function lucas(n) {
  for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_),__--);
  return (++[+[]][+[]]/++[++[+[]][+[]]][+[]] + Math.pow(_, n-1)) | 0;
}
</code></pre><p>Sweet. We get 2 from exploiting the trick we used for 1: ++[0][0] is one, ++[1][0] is two, ++[2][0] is three, etc... but now to get rid of Math.pow: as you&#39;ll recall from basic arithmetic, a<sup>b</sup> is just <code>a*a*...*a</code> with <code>b-1</code> multiplications, so:</p>
<pre><code>for(var temp = a, b = ...; --b&gt;0; a *= temp); a
</code></pre><p>Easy enough:</p>
<pre><code>function lucas(n) {
  for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_),__--);
  for(var temp = _, b = n-1; --b&gt;0; _ *= temp);
  return (++[+[]][+[]]/++[++[+[]][+[]]][+[]] + _) | 0;
}
</code></pre><p>But let&#39;s get rid of that <code>b</code>, too, since we already have <code>n</code> and it doesn&#39;t matter what happens to it:</p>
<pre><code>function lucas(n) {
  for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_),__--);
  for(var temp = _; --n+1&gt;0; _ *= temp);
  return (++[+[]][+[]]/++[++[+[]][+[]]][+[]] + _) | 0;
}
</code></pre><p>Nice! One last trick we can use is that in Javascript <code>if (... !== 0)</code> can be shortcircuited by exploiting the fact that JS will try to turn something into a conditional if it isn&#39;t one, so we can say <code>if (...)</code>:</p>
<pre><code>function lucas(n) {
  for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_),__--);
  for(var temp = _; --n+1; _ *= temp);
  return (++[+[]][+[]]/++[++[+[]][+[]]][+[]] + _) | 0;
}
</code></pre><p>Now, we can use <code>__</code> as our temp var, since we won&#39;t need it anymore, and we&#39;re pretty much done:</p>
<pre><code>function lucas(n) {
  for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+(++[+[]][+[]]/_),__--);
  for(__=_;-++[+[]][+[]]+n--;_*=__);
  return (++[+[]][+[]]/++[++[+[]][+[]]][+[]] + _) | 0;
}
</code></pre><p>And as  whitespace isn&#39;t semantic, let&#39;s remove all of that:</p>
<pre><code>function l(n){for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+
(++[+[]][+[]]/_),__--);for(__=_;-++[+[]][+[]]+--n;_*=__);return(++[+[]][+[]]/++[++[+[]][+[]]][+[]]+_)|+[];}
</code></pre><p>Done! If we call this as <code>l(1)</code> we&#39;ll get stuck in an infinite loop, but that&#39;s okay, as we can only start generating as of the 3rd Lucas number anyway. If we do, <code>l(3)</code> is 3, <code>l(4)</code> is 4, <code>l(5)</code> is 7, <code>l(6)</code> is 11, and so on.</p>
<p>Thanks for letting me waste your time.</p>
<p><strong>update</strong>: You might have spotted an &quot;optimisation&quot; here, because <code>__</code> is 1.[something], so <code>__|0</code> is 1. We can use this in our return statement to further compact while staying utterly unreadable:</p>
<pre><code>function l(n){for(_=++[+[]][+[]],__=++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;++[_][+[]]&lt;&lt;_;__&gt;+[];_=++[+[]][+[]]+
(++[+[]][+[]]/_),__--);for(__=_;-++[+[]][+[]]+--n;_*=__);return(__|0/++[__|0][+[]]+_)|+[];}
</code></pre><p>We could also use <code>__|0/(__|0)&lt;&lt;__|0</code> but that&#39;s actually far more readable, so let&#39;s not.</p>
</description>
<category>Maths</category>
<category>JavaScript</category>
<category>Fibonacci</category>
<category>Lucas</category>
<link>http://pomax.github.io/gh-blog/#gh-weblog-1419794486361</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1419794486361</guid>
<pubDate>Sun, 28 Dec 2014 19:21:26 GMT</pubDate>
</item>
<item>
<title>Appmaking at MozFest 2014</title>
<description><p>Two weeks ago we hosted <a href="http://2014.mozillafestival.org">MozFest 2014</a> in London (UK, not Ontario), with lots of <a href="http://apps.webmaker.org">appmaker</a> related sessions, including a weekend long &quot;introduction to appmaker&quot; that I ran with the help of the wonderful <a href="https://twitter.com/McBeckster">Becky Weir</a>, and it was great to see people going from &quot;I have no idea what this is&quot; to &quot;I am remixing apps for giggles&quot; and &quot;I have an idea for an app, let me try to make it&quot;.  MozFest 2014 was the first big event that had the current version of Appmaker in the hands of the public, so it was a good time to see what worked, and what didn&#39;t.</p>
<h3 id="what-worked">What worked</h3>
<p>It&#39;s easy to imagine that it&#39;s important to have some fun components as well as some tedious logics components for apps while you&#39;re developing software like this, but it&#39;s not until you ask people to play with it that you realise exactly <em>how</em> important it is to have fun components. A few weeks before MozFest, <a href="http://scottdowne.wordpress.com">Scott Downe</a> had made a simple top-down 2d game level brick, as well as a retro-looking game controller brick, and while those were fun to play with, it wasn&#39;t until he and Becky <a href="https://scott.makes.org/thimble/LTE4NzA1MjgyNTY=/mozfest-appmaker-games">wrote some tutorials on how to use them</a> that it was obvious exactly how important these bricks were - they literally made appmaker a fun thing to play with, and without them I have no doubt in my mind that Appmaker would have been received far less positively.</p>
<p>During the MozFest weekend the fact that if a tool can&#39;t let you have fun, people aren&#39;t going to want to use it, was so much more obvious than you get testing it with people in an office, or with people who&#39;ve heard you talk about it before. If someone has never seen your tool before, and within minutes can have fun, that&#39;s a tool they want to come back to later.</p>
<h3 id="what-didn-t-work">What didn&#39;t work</h3>
<p>We&#39;re missing essential functionality of which we either didn&#39;t know it was essential, or didn&#39;t think was as essential as it turned out to be. So, a list of sorts:</p>
<ol>
<li>We&#39;re missing components to do things that people care about: accessing online APIs, parsing that data, and plotting that data/routing it on to more user-engaging components. In fact, it turns out this is so essential that during the closing demos party, there was a version of appmaker being shown that had these things hacked in, in order to show off an app that showed weather and atmospheric data, plotted over time. That&#39;s really cool! And that should have been a thing that was already possible rather than requiring a fork with hacks.</li>
<li>We&#39;re missing the functionality for people to make their own component, and link that into their app. This is something that we actually used to have, but we had to disable quite a while ago due to complexities, and did not maintain while we rewrote Appmaker&#39;s core functionality. Especially given the missing components in the previous point, this one&#39;s plain annoying.</li>
<li>As a web technology, and this one&#39;s really interesting, we&#39;re missing an import function, where we say &quot;my app actually lives over on <a href="http://someplace/app.html">http://someplace/app.html</a>&quot; and have Appmaker load that app into the designer for editing. Even a &quot;paste in your code&quot; function so that people who&#39;ve been working in a local copy of Appmaker would have made a different given that internet can be spotty, and running a login-less, database-less local copy of appmaker is really easy.</li>
</ol>
<p>Of course there were also the usual bugs that only come out during massive testing, such as the fact that a component we thought we&#39;d removed still being listed, or a not-often-used component not behaving properly, which is always great to discover, if a little embarassing!</p>
<h3 id="what-s-next-">What&#39;s next?</h3>
<p>One of the major activities on Appmaker following MozFest is clean-up. In the runup to MozFest, as well as over the past few months overhauling parts of the codebase, we&#39;ve had a fair bit of build-up of dead code, unclean code, and of course, hacks to make things work &quot;well enough&quot; rather than &quot;properly&quot;. It&#39;s time to address those issues, while also spending some time on working on the issues that surfaced during MozFest, to add essential components, and crucially: make real apps and document the process as learning kits, because if there are no recipes to follow, exploring a complex tool is not fun; it&#39;s a chore. There&#39;s also some technical debt that we need to repay in the form of hacks we did on the technologies that underpin Appmaker, which should be rewritten as proper patches and submitted as patch requests to the relevant projects.</p>
<p><strong>tl;dr: add essential components, custom components, and tutorials, tutorials, tutorials.</strong></p>
<h2 id="the-take-home-message">The take-home message</h2>
<p>People really liked Appmaker, and that&#39;s great! They also had expectations that we didn&#39;t or couldn&#39;t meet, and that&#39;s not great from a &quot;result&quot; perspective, but <em>is</em> great from a &quot;learning what people want&quot; perspective. Also, and really once again, it&#39;s been made clear that tools that can&#39;t let you have fun aren&#39;t worth spending time on, and Appmaker can certainly do with more fun. That doesn&#39;t necessarily mean Appmaker itself needs to be made more fun, but we need more components and, crucially, good tutorials, on how to have fun in Appmaker by making something that&#39;s not just a cut and dry purpose-built app, but something you can keep playing with after you made it.</p>
<p>If you were at MozFest 2014, or you have an interest in Appmaker and helping us improve it, you can find us in the #appmaker IRC channel on irc.mozilla.org (if you like real-time interacting) or on github over at <a href="https://github.com/mozilla-appmaker/appmaker">github.com/mozilla-appmaker/appmaker</a> if you prefer the more ticket-based communication. With everyone slowly returning to work after post-MozFest vacations (a yearly tradition!) I&#39;m looking forward to making Appmaker leaner, faster, and more what you want, based on what you&#39;ve told us!</p>
</description>
<category>Webmaker</category>
<category>Appmaker</category>
<category>Mozilla</category>
<category>MozFest</category>
<link>http://pomax.github.io/gh-blog/#gh-weblog-1415815317842</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1415815317842</guid>
<pubDate>Wed, 12 Nov 2014 18:01:57 GMT</pubDate>
</item>
<item>
<title>A quick ink update</title>
<description><p>Updating <a href="http://inkcyclopedia.org">inkcyclopedia</a> with some more inks to fill in the gaps (oh yes.. there are gaps...) so I&#39;ve added some loose ends (like ink lines of which I had most-except-4-to-7) which is <a href="http://imgur.com">imgur</a> album&#39;d <a href="http://imgur.com/gallery/7rXCP">here</a>, and there will be a few larger batches added when I have time. I have an additional 70 de Atramentis inks sitting on the table waiting for when I have time to pen them up, after that it&#39;s probably just going to be the remaining Diamine and Noodler&#39;s Inks and then there&#39;ll be a stupid amount of inks on the site and it&#39;s utility will come from being useful when selecting inks. Meaning I need to get on those improvements for viewing samples and getting stats about the inks (composition, flowiness, feathering, shading, wetness,  etc. etc. etc).</p>
<p><img src="https://i.imgur.com/zHUSlaT.jpg" class="border" style="width: 50%; margin: 1em; margin-left: 25%;"></p>
</description>
<category>Inkcyclopedia</category>
<category>Fountain</category>
<category>Pen</category>
<category>Ink</category>
<link>http://pomax.github.io/gh-blog/#gh-weblog-1412703241308</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1412703241308</guid>
<pubDate>Tue, 07 Oct 2014 17:34:01 GMT</pubDate>
</item>
<item>
<title>Bezier.js, for doing bezier curve things</title>
<description><p>I was asked if I would be willing to write an SVG path-to-outline conversion library, and figured I might as well set up some jump boards for doing that. One of those is <a href="http://pomax.github.io/bezierjs">Bezier.js</a> which I &quot;released&quot; today (meaning it has working code and a demo, but no registered npm/bower entries yet).</p>
<p>It&#39;s a small bezier curve library that does the essential things like generating plot points, derivatives, normals, inflection points, curve offsetting, etc. Give the demo a try, and read through <a href="https://github.com/Pomax/bezierjs/blob/gh-pages/beziertest.js">the example code</a>. It&#39;s pretty easy!</p>
</description>
<category>Bezier</category>
<category>Curves</category>
<category>Maths</category>
<link>http://pomax.github.io/gh-blog/#gh-weblog-1412572015743</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1412572015743</guid>
<pubDate>Mon, 06 Oct 2014 05:06:55 GMT</pubDate>
</item>
<item>
<title>#Let's simplify installations.</title>
<description><p><a href="https://webmaker.org">Webmaker</a> is a collection of tools that are awesome. Getting them all up and running at the same time, however, is somewhat the opposite of that qualifier, so in order to make the process easier, about a year ago, I wrote the &quot;webmaker suite&quot; - a set of scripts that could do things like install all our apps, update them, and run them.</p>
<p>That sounds pretty useful, and it was, but it was also a lot of &quot;scripts&quot;. It was certainly friendlier than telling someone to clone ten apps themselves and do the whole npm install thing, but it was a lot of runtime flags to make sure only the right things would start up or install or update, and I finally had enough.</p>
<p>Programmers do their best work on things that scratch an itch, and I just got a new work laptop, which needed webmaker-suite installed. I was not happy. Why didn&#39;t we just have a package manager, really, so I could just say &quot;grab me X, Y, and Z, and let me run them&quot;? Well, pretty much because I never wrote it. How dare I be so lazy!</p>
<p>So I took a day to just implement a package manager for webmaker and in the process ended up writing a pretty sweet retro menu system program package .. thing... for node.js that you can find <a href="http://github.com/Pomax/terminal-menu-program">here</a> (based on the already existing <a href="https://www.npmjs.org/package/terminal-menu">terminal-menu</a> package).</p>
<p><img src="https://cloud.githubusercontent.com/assets/177243/4414059/0e4e9a00-4510-11e4-924e-59db1c523557.png"></p>
<p>With that in place, it was suddenly possible to write an app manager for webmaker, and I&#39;m pretty sure I can make it slightly more generic so that you, too, can use it for managing your multi-app setup without having to write all the scripts yourself. But that&#39;ll be for another post. For now, I&#39;m working on making sure that you can simple-navigate your way through our installer and be up and running in the time it takes to automatically run some installers, and not really much more:</p>
<p><img src="images/webmaker-menu-01.jpg"></p>
<p>And you&#39;ll have the freedom to set up multiple run profiles so that you can run exactly what you want to run, when you need it:</p>
<p><img src="images/webmaker-menu-02.jpg"></p>
<p>Right now external dependencies like <a href="https://www.java.com/en/download/index.jsp">Java</a>, <a href="www.elasticsearch.org/overview/elkdownloads">ElasticSearch</a>, and <a href="www.mongodb.org/downloads">MongoDB</a> are still up to you, but hopefully I can somehow cleverly work that in, too, and then everything will be fantastic.</p>
</description>
<category>Mozilla</category>
<category>Webmaker</category>
<category>Node</category>
<link>http://pomax.github.io/gh-blog/#gh-weblog-1411780655333</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1411780655333</guid>
<pubDate>Sat, 27 Sep 2014 01:17:35 GMT</pubDate>
</item>
<item>
<title>I've never met you, so I have no reason to trust you. or your CLA.</title>
<description><p>You run an open source project, and I have a meaningful contribution for you. I&#39;d love to submit it, but now you&#39;re asking me for my personal information, without ever having shown that you can be trusted with that: I&#39;m not signing your CLA.</p>
<p>You may have seen articles of the &quot;I will not sign your NDA&quot; variety popping up in your newsfeeds every now and then, and this post is in the same vein. I will not sign your CLA, and there&#39;s a very good reason for it.</p>
<p>You probably have a cool project, and it was born out of some bigger effort, or you happen to work closely with a bigger effort. For instance, you&#39;re the  <a href="polymer-project.org">polymer</a> or <a href="ttps://github.com/Khan/KaTeX">KaTeX</a> project, and your code is really quite cool, and really quite useful, and I&#39;m not even being sarcastic here, I love both those projects. But the companies you work(ed) for know the troubles of contributors demands post-patch-acceptance, and they, or their lawyers, made you add a wholly unreasonable CLA to your project.</p>
<p>Let&#39;s make this clear: I know what kind of shit storm can take place without a CLA. This is not a post about how &quot;you should not have to worry about this&quot;, because it&#39;s a very real thing; nor is this a post about how &quot;you shouldn&#39;t have a CLA, ever&quot;, because CLAs make sense for projects where an individual can properly ruin the party for many, many people. Chromium needs a CLA. The Firefox codebase needs a CLA. Twitter, Facebook, Kahn Academy, Google, all of those requiring you sign a CLA to work on their projects <strong>as part of their product offerings</strong> are fine.</p>
<p>But don&#39;t act bigger than you are. Asking people to tell you their name, phone number, and real world address, is kind of a big deal: what are you going to do with that information? How do I know you&#39;re not lying when you tell me it&#39;s only for legal purposes? What have you done to deserve my faith in you? What have you done to show none of your project members have access to that information? Because if I have a twitter spat with someone, they sure as hell shouldn&#39;t have the power to look up my phone number and home address in a CLA registry. And what have you done to show that the information you&#39;re asking for is even meaningful?</p>
<p>There are reasons I won&#39;t sign a CLA for Google or Facebook: they haven&#39;t earned my trust. Kind of the opposite, really, I trust them to abuse my personal information for as many dollars as they can get out of it. However, I will happily sign a CLA with Mozilla, or the Red Cross, because they&#39;ve shown they can be trusted with this kind of information.</p>
<p>Bottom line: I don&#39;t trust you. If you were a project born out of a Google idea and now you&#39;re on your own and you have nothing to do with actual Google projects (I&#39;m looking at you, Polymer) or you&#39;re a Kahn Academy project that is being spun as a replacement for MathJax, not tied into the Kahn Academy codebase at all (I&#39;m looking at you, KaTeX), then you are no longer Google or Kahn Academy. You&#39;re projects without the authority of your parent to back you up, and you&#39;re new on the open source map. I haven&#39;t heard anything bad about what you do with identity information from real human beings, but then I&#39;ve heard nothing good, either: I don&#39;t trust you, because I don&#39;t think it&#39;s unrealistic we&#39;re going to disagree on something in an issue I file, and I don&#39;t think it&#39;s unrealistic to imagine tempers might flare and someone&#39;s going to end up looking up my personal information and take things offline. I fully imagine that to be imaginary, but this is the real world, and you&#39;re asking for real, personally identifiable information. You need to earn the right to ask for that that; you don&#39;t have that right just because you&#39;re an open source project.</p>
<p>Can you explain why you need my name, my phone number, and my real world address? &quot;The lawyers said it was okay&quot; is not a good enough answer. What if I have no phone? I actually don&#39;t, I have no use for one. What if I have no permanent address? I actually do, but I know people wo don&#39;t, and you can&#39;t read hacker news without hitting an article about people working out of coffee shops with $2500 macbooks but no permanent address fairly often. Can you explain why you&#39;re discriminating against people in this way? Because it&#39;s kind of bizarre, but there it is: your CLA is discriminating again those less well off. Kind of generally the kind of people who benefit most from open source projects (note: &quot;most&quot;; people with phones and permanent addresses obviously benefit from open source, but the less you have, the more important freely accessible tools are)</p>
<p>For what a CLA was originally intended for, it has to discriminate at least enough to identify you as the person you claim to be, but if your project is not the used-by-millions powerhouse of a Discourse or Elasticsearch, your use of a CLA is not about making sure a patch is legally safe to merge in. You&#39;re just doing what you&#39;ve been told without asking whether that even made sense and fighting for open source. You&#39;re actually making open source feel worse by pretending we all need to sign these things before we can even contribute code and help build a better world. And ironically, the CLA, designed to make sure patches can be landed, actually sets an artificial bar for what you consider a worthy contributor. When you look at it that way, and I so very much do, it&#39;s kind of sad and sickening and I don&#39;t understand why you&#39;re denigrating people by insisting on a nonsense agreement for which I could make up random numbers and letters and you will not even question it because you have no way of verifying the information short of sending someone to the address I give you and calling the phone number I provided. To which I can claim to never be home, and that I changed phone numbers since signing that CLA.</p>
<p>In the end, that CLA is <em>your</em> insurance against <em>me</em> not liking how you run your small project... so let&#39;s get real: we could have settled that issue with a single-line agreement that says &quot;by contributing you sign over all transferable rights pertaining to your contribution to this project&quot; and done. I don&#39;t trust you, and your CLA just told me you don&#39;t trust me either.</p>
<p>Yeah, I think we&#39;re off to a great start.</p>
</description>
<category>Open Source</category>
<category>CLA</category>
<link>http://pomax.github.io/gh-blog/#gh-weblog-1411176119356</link>
<guid>http://pomax.github.io/gh-blog/#gh-weblog-1411176119356</guid>
<pubDate>Sat, 20 Sep 2014 01:21:59 GMT</pubDate>
</item></channel>
</rss>
